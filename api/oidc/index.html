<!DOCTYPE html><html lang="en"><head>
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<meta name="generator" content="ReSpec 34.1.4">
<style>
span.example-title{text-transform:none}
:is(aside,div).example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
div.illegal-example{color:red}
div.illegal-example p{color:#000}
:is(aside,div).example{border-left-width:.5em;border-left-style:solid;border-color:#e0cb52;background:#fcfaee}
aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
.example pre{background-color:rgba(0,0,0,.03)}
</style>
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;color:#000;box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;margin-top:.25em}
.dfn-panel ul a[href]{color:#333}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
  
  
  
  
  
  
  
<script>document.title = respecConfig.title</script>
<title>NL GOV profile for OpenID Connect 1.0.1</title>
  
<title>Default</title>
  
<link rel="shortcut icon" type="image/x-icon" href="https://gitdocumentatie.logius.nl/publicatie/respec/style/logos/logius.ico">
  

<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
:is(h1,h2,h3,h4,h5,h6,a) abbr{border:none}
dfn{font-weight:700}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
.toc a,.tof a{text-decoration:none}
a .figno,a .secno{color:#000}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
table.simple{border-spacing:0;border-collapse:collapse;border-bottom:3px solid #005a9c}
.simple th{background:#005a9c;color:#fff;padding:3px 5px;text-align:left}
.simple th a{color:#fff;padding:3px 5px;text-align:left}
.simple th[scope=row]{background:inherit;color:inherit;border-top:1px solid #ddd}
.simple td{padding:3px 10px;border-top:1px solid #ddd}
.simple tr:nth-child(even){background:#f0f6ff}
.section dd>p:first-child{margin-top:0}
.section dd>p:last-child{margin-bottom:0}
.section dd{margin-bottom:1em}
.section dl.attrs dd,.section dl.eldef dd{margin-bottom:0}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline;position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-.7em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
<style id="respec-nlgov">
img.license{float:left;padding-right:5px}
</style>
<style>
ul.index{columns:30ch;column-gap:1.5em}
ul.index li{list-style:inherit}
ul.index li span{color:inherit;cursor:pointer;white-space:normal}
#index-defined-here ul.index li{font-size:.9rem}
ul.index code{color:inherit}
#index-defined-here .print-only{display:none}
@media print{
#index-defined-here .print-only{display:initial}
}
</style>
<meta name="description" content="The OpenID Connect protocol defines an identity federation system that allows
a Relying Party to request and receive authentication and profile information
about an End-User.">
<style>
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}
.hljs-comment,.hljs-quote{color:#717277;font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;font-weight:700}
.hljs-literal{color:#0b76c5}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>

  .sidelabel {
    position: fixed;
    -webkit-transform-origin: top right;
    right: 100%;
    top: 0;
    -webkit-transform: rotate(-90deg);
    padding: 4px 50px 4px 10px;
    color: white;
    white-space: nowrap;
    z-index: 1;
    background-color: #154273;
  }
</style>
<script id="initialUserConfig" type="application/json">{
  "nl_organisationName": "Logius",
  "nl_organisationStylesURL": "https://gitdocumentatie.logius.nl/publicatie/respec/style/",
  "nl_organisationPublishURL": "https://gitdocumentatie.logius.nl/publicatie/",
  "logos": [
    {
      "src": "https://gitdocumentatie.logius.nl/publicatie/respec/style/logos/figure-logius.svg",
      "alt": "Logius",
      "id": "Logius",
      "height": 77,
      "width": 44,
      "url": "https://www.logius.nl/standaarden"
    }
  ],
  "latestVersion": [
    "nl_organisationPublishURL",
    "pubDomain",
    "/",
    "shortName"
  ],
  "thisVersion": [
    "nl_organisationPublishURL",
    "pubDomain",
    "/",
    "shortName",
    "/",
    "publishVersion"
  ],
  "prevVersion": [
    "nl_organisationPublishURL",
    "pubDomain",
    "/",
    "shortName",
    "/",
    "previousPublishVersion"
  ],
  "useLogo": true,
  "useLabel": true,
  "license": "cc-by",
  "addSectionLinks": true,
  "localizationStrings": {
    "en": {
      "wv": "Draft",
      "cv": "Recommendation",
      "vv": "Proposed recommendation",
      "def": "Definitive version",
      "basis": "Document",
      "eo": "Outdated version",
      "tg": "Rescinded version",
      "no": "Norm",
      "st": "Standard",
      "im": "Information model",
      "pr": "Guideline",
      "hr": "Guide",
      "wa": "Proposed recommendation",
      "al": "General",
      "bd": "Governance documentation",
      "bp": "Best practice"
    },
    "nl": {
      "wv": "Werkversie",
      "cv": "Consultatieversie",
      "vv": "Versie ter vaststelling",
      "def": "Vastgestelde versie",
      "basis": "Document",
      "eo": "Verouderde versie",
      "tg": "Teruggetrokken versie",
      "no": "Norm",
      "st": "Standaard",
      "im": "Informatiemodel",
      "pr": "Praktijkrichtlijn",
      "hr": "Handreiking",
      "wa": "Werkafspraak",
      "al": "Algemeen",
      "bd": "Beheerdocumentatie",
      "bp": "Best practice"
    }
  },
  "sotdText": {
    "nl": {
      "sotd": "Status van dit document",
      "def": "Dit is de definitieve versie van dit document. Wijzigingen naar aanleiding van consultaties zijn doorgevoerd.",
      "wv": "Dit is een werkversie die op elk moment kan worden gewijzigd, verwijderd of vervangen door andere documenten. Het is geen door het TO goedgekeurde consultatieversie.",
      "cv": "Dit is een door het TO goedgekeurde consultatieversie. Commentaar over dit document kan gestuurd worden naar ",
      "vv": "Dit is een definitief concept van de nieuwe versie van dit document. Wijzigingen naar aanleiding van consultaties zijn doorgevoerd.",
      "basis": "Dit is een document zonder officiële status."
    },
    "en": {
      "sotd": "Status of This Document",
      "def": "This is the definitive version of this document. Edits resulting from consultations have been applied.",
      "wv": "This is a draft that could be altered, removed or replaced by other documents. It is not a recommendation approved by TO.",
      "cv": "This is a proposed recommendation approved by TO. Comments regarding this document may be sent to ",
      "vv": "This is the definitive concept of this document. Edits resulting from consultations have been applied.",
      "basis": "This document has no official standing."
    }
  },
  "labelColor": {
    "def": "#154273",
    "wv": "#39870c"
  },
  "licenses": {
    "cc0": {
      "name": "Creative Commons 0 Public Domain Dedication",
      "short": "CC0",
      "url": "https://creativecommons.org/publicdomain/zero/1.0/",
      "image": "https://gitdocumentatie.logius.nl/publicatie/respec/media/logos/cc-zero.svg"
    },
    "cc-by": {
      "name": "Creative Commons Attribution 4.0 International Public License",
      "short": "CC-BY",
      "url": "https://creativecommons.org/licenses/by/4.0/legalcode",
      "image": "https://gitdocumentatie.logius.nl/publicatie/respec/media/logos/cc-by.svg"
    },
    "cc-by-nd": {
      "name": "Creative Commons Naamsvermelding-GeenAfgeleideWerken 4.0 Internationaal",
      "short": "CC-BY-ND",
      "url": "https://creativecommons.org/licenses/by-nd/4.0/legalcode.nl",
      "image": "https://gitdocumentatie.logius.nl/publicatie/respec/media/logos/cc-by-nd.svg"
    }
  },
  "localBiblio": {
    "ebMS3": {
      "href": "https://docs.oasis-open.org/ebxml-msg/ebms/v3.0/core/ebms_core-3.0-spec.pdf",
      "title": "OASIS ebXML Messaging Services 3 Version 3.0: Part 1, Core Features",
      "authors": [
        "Ian Jones",
        "Pete Wenzel"
      ],
      "date": "October 2007",
      "publisher": "OASIS"
    },
    "BPSS": {
      "href": "http://www.ebxml.org/specs/ebBPSS.pdf",
      "title": "ebXML Business Process Specification Schema",
      "authors": [
        "Paul  Levine"
      ],
      "date": "May 2001",
      "publisher": "OASIS"
    },
    "eIDAS.SAML": {
      "href": "https://ec.europa.eu/cefdigital/wiki/download/attachments/82773108/eIDAS%20SAML%20Message%20Format%20v.1.2%20Final.pdf",
      "title": "eIDAS SAML Message Format",
      "publisher": "eIDAS Coorperation Network",
      "id": "eidas.saml"
    },
    "LO.GBA": {
      "href": "h https://www.rvig.nl/logisch-ontwerp-brp ",
      "title": " Logisch ontwerp BRP",
      "authors": [
        ""
      ],
      "date": "July 2023",
      "publisher": "RvIG",
      "id": "lo.gba"
    },
    "OAuth2.1": {
      "href": "https://tools.ietf.org/html/draft-parecki-oauth-v2-1",
      "title": "OAuth 2.1 Working draft",
      "authors": [
        "D. Hardt",
        "A. Parecki",
        "T. Lodderstedt"
      ],
      "date": "April 2020",
      "publisher": "IETF OAuth Working Group",
      "id": "oauth2.1"
    },
    "OAuth2.Browser-Based-Apps": {
      "href": "https://tools.ietf.org/html/draft-ietf-oauth-browser-based-apps",
      "title": "OAuth 2.0 for Browser-Based Apps",
      "authors": [
        "A. Parecki",
        "D. Waite"
      ],
      "status": "Internet-Draft",
      "publisher": "IETF OAuth Working Group",
      "id": "oauth2.browser-based-apps"
    },
    "OAuth2.JAR": {
      "href": "https://tools.ietf.org/html/draft-ietf-oauth-jwsreq",
      "title": "The OAuth 2.0 Authorization Framework: JWT Secured Authorization Request (JAR)",
      "authors": [
        "N. Sakimura",
        "J. Bradley"
      ],
      "status": "Internet-Draft",
      "publisher": "IETF OAuth Working Group",
      "id": "oauth2.jar"
    },
    "OAuth2.JWT": {
      "href": "https://tools.ietf.org/html/draft-ietf-oauth-access-token-jwt",
      "title": "JSON Web Token (JWT) Profile for OAuth 2.0 Access Tokens",
      "authors": [
        "V. Bertocci"
      ],
      "status": "Internet-Draft",
      "publisher": "IETF OAuth Working Group",
      "id": "oauth2.jwt"
    },
    "OAuth2.NLGov": {
      "href": "https://gitdocumentatie.logius.nl/publicatie/api/oauth/",
      "title": "NL GOV Assurance profile for OAuth 2.0",
      "authors": [
        "F. Terpstra",
        "J. van Gelder"
      ],
      "date": "july 2020",
      "publisher": "Logius",
      "id": "oauth2.nlgov"
    },
    "OAuth2.PAR": {
      "href": "https://tools.ietf.org/html/draft-lodderstedt-oauth-par",
      "title": "OAuth 2.0 Pushed Authorization Requests",
      "authors": [
        "T. Lodderstedt",
        "B. Campbell",
        "N. Sakimura",
        "D. Tonge",
        "F. Skokan"
      ],
      "status": "Internet-Draft",
      "publisher": "IETF OAuth Working Group",
      "id": "oauth2.par"
    },
    "OAuth2.RAR": {
      "href": "https://tools.ietf.org/html/draft-lodderstedt-oauth-rar",
      "title": "OAuth 2.0 Rich Authorization Requests",
      "authors": [
        "T. Lodderstedt",
        "J. Richer",
        "B. Campbell"
      ],
      "status": "Internet-Draft",
      "publisher": "IETF OAuth Working Group",
      "id": "oauth2.rar"
    },
    "OAuth2.Security": {
      "href": "https://tools.ietf.org/html/draft-ietf-oauth-security-topics",
      "title": "OAuth 2.0 Security Best Current Practice",
      "authors": [
        "T. Lodderstedt",
        "J. Bradley",
        "A. Labunets",
        "D. Fett"
      ],
      "status": "Internet-Draft",
      "publisher": "IETF OAuth Working Group",
      "id": "oauth2.security"
    },
    "OpenID.Core": {
      "href": "https://openid.net/specs/openid-connect-core-1_0.html",
      "title": "OpenID Connect Core 1.0",
      "authors": [
        "N. Sakimura",
        "J. Bradley",
        "M. B. Jones",
        "B. de Medeiros",
        "C. Mortimore"
      ],
      "date": "2014",
      "publisher": "The OpenID Foundation",
      "id": "openid.core"
    },
    "OpenID.Discovery": {
      "href": "https://openid.net/specs/openid-connect-discovery-1_0.html",
      "title": "OpenID Connect Discovery 1.0",
      "authors": [
        "N. Sakimura",
        "J. Bradley",
        "M. Jones",
        "E. Jay"
      ],
      "date": "2014",
      "publisher": "The OpenID Foundation",
      "id": "openid.discovery"
    },
    "OpenID.Dynamic-Registration": {
      "href": "https://openid.net/specs/openid-connect-registration-1_0.html",
      "title": "OpenID Connect Dynamic Client Registration 1.0",
      "authors": [
        "N. Sakimura",
        "J. Bradley",
        "M. Jones"
      ],
      "date": "2014",
      "publisher": "The OpenID Foundation",
      "id": "openid.dynamic-registration"
    },
    "OpenID.iGov": {
      "href": "https://openid.net/specs/openid-igov-openid-connect-1_0.html",
      "title": "International Government Assurance Profile (iGov) for OpenID Connect 1.0",
      "authors": [
        "M. Varley",
        "P. Grassi"
      ],
      "date": "2018",
      "publisher": "The OpenID Foundation",
      "id": "openid.igov"
    },
    "OpenID.Federation": {
      "href": "https://openid.net/specs/openid-connect-federation-1_0-12.html",
      "title": "OpenID Connect Federation 1.0 - draft 12",
      "authors": [
        "R. Hedberg",
        "M. Jones",
        "A. Solberg",
        "S. Gulliksson",
        "J. Bradley"
      ],
      "date": "June 30, 2020",
      "published": "The OpenID Foundation",
      "id": "openid.federation"
    },
    "PKI-CA": {
      "href": "https://www.logius.nl/diensten/pkioverheid/aansluiten-als-tsp/toegetreden-vertrouwensdienstverleners",
      "title": "Toegetreden vertrouwensdienstverleners",
      "authors": [
        ""
      ],
      "date": "2018",
      "publisher": "Logius"
    },
    "PKI.Policy": {
      "href": "https://www.logius.nl/sites/default/files/public/bestanden/diensten/PKIoverheid/Deel2-eisen-voor-TSPs-v4.7.pdf",
      "title": "Programma van Eisen deel 2: Toetreding tot en toezicht binnen de PKI voor de overheid",
      "authors": [
        ""
      ],
      "date": "8 februari 2019",
      "publisher": "Logius"
    },
    "SG.TLS": {
      "href": "https://english.ncsc.nl/publications?keyword=IT+Security+Guidelines+for+Transport+Layer+Security&start-date=&end-date=&topic=All+topics&type=All+publications",
      "title": " IT Security Guidelines for Transport Layer Security (TLS)",
      "authors": [
        ""
      ],
      "date": "23-05-2019",
      "publisher": "NCSC",
      "id": "sg.tls"
    },
    "SG.LoA": {
      "href": "https://www.forumstandaardisatie.nl/sites/default/files/BFS/4-basisinformatie/publicaties/Assurance-levels-for-digital-service-provision.pdf",
      "title": "Assurance level for digital service provision",
      "authors": [
        ""
      ],
      "date": "September 2017",
      "publisher": "The Standardisation Forum (NL)",
      "id": "sg.loa"
    },
    "UMMR10": {
      "href": "https://www.unece.org/fileadmin/DAM/cefact/umm/UMM_Revision_10_2001.zip",
      "title": "UN/CEFACT Modelling Methodology (UMM) Revison 10",
      "authors": [
        ""
      ],
      "date": "2001",
      "publisher": "UN/CEFACT"
    }
  },
  "specStatus": "DEF",
  "specType": "ST",
  "pubDomain": "api",
  "shortName": "oidc",
  "publishDate": "2023-09-18",
  "publishVersion": "1.0.1",
  "previousVersion": "1.0",
  "previousPublishDate": "2021-02-18",
  "previousMaturity": "WV",
  "title": "NL GOV profile for OpenID Connect",
  "content": {
    "Introduction": "",
    "UseCase": "",
    "Flow": "",
    "ClientProfile": "",
    "ProviderProfile": "",
    "UserInfo": "",
    "Considerations": "",
    "Appendix": "informative"
  },
  "editors": [
    {
      "name": "Remco Schaar",
      "company": "Logius",
      "companyURL": "https://github.com/Logius-standaarden"
    },
    {
      "name": "Frank van Es",
      "company": "Logius",
      "companyURL": "https://github.com/Logius-standaarden"
    },
    {
      "name": "Pieter Hering",
      "company": "Logius",
      "companyURL": "https://github.com/Logius-standaarden"
    },
    {
      "name": "Martin van der Plas",
      "company": "Logius",
      "companyURL": "https://github.com/Logius-standaarden"
    },
    {
      "name": "Alexander Green",
      "company": "Logius",
      "companyURL": "https://github.com/Logius-standaarden"
    }
  ],
  "authors": [
    {
      "name": "Remco Schaar",
      "company": "Logius",
      "companyURL": "https://github.com/Logius-standaarden"
    },
    {
      "name": "Frank van Es",
      "company": "Logius",
      "companyURL": "https://github.com/Logius-standaarden"
    },
    {
      "name": "Joris Joosten",
      "company": "VZVZ",
      "companyURL": "https://www.vzvz.nl/"
    },
    {
      "name": "Jan Geert Koops",
      "company": "Dictu",
      "companyURL": "https://www.dictu.nl/"
    }
  ],
  "github": "https://github.com/Logius-standaarden/OIDC-NLGOV/",
  "alternateFormats": [
    {
      "label": "pdf",
      "uri": "NLGov-OpenIDConnect-profile.pdf"
    }
  ]
}</script>
<link rel="stylesheet" href="https://gitdocumentatie.logius.nl/publicatie/respec/style/base.css"></head>

<body class="h-entry"><div class="head">
    <a class="logo" href="https://www.logius.nl/standaarden"><img alt="Logius" height="77" id="Logius" src="https://gitdocumentatie.logius.nl/publicatie/respec/style/logos/figure-logius.svg" width="44">
  </a> <h1 id="title" class="title">NL GOV profile for OpenID Connect 1.0.1</h1>
    
    <h2>
      Logius Standard<br>
      Definitive version
      <time class="dt-published" datetime="2023-09-18">September 18, 2023</time>
    </h2>
    <dl>
      <dt>This version:</dt><dd class="status">
              <a class="u-url status" href="https://gitdocumentatie.logius.nl/publicatie/api/oidc/1.0.1">https://gitdocumentatie.logius.nl/publicatie/api/oidc/1.0.1</a>
            </dd>
      <dt>Latest published version:</dt><dd>
              <a href="https://gitdocumentatie.logius.nl/publicatie/api/oidc">https://gitdocumentatie.logius.nl/publicatie/api/oidc</a>
            </dd>
      <dt>Latest editor's draft:</dt><dd><a href="https://logius-standaarden.github.io/OIDC-NLGOV/">https://logius-standaarden.github.io/OIDC-NLGOV/</a></dd>
      
      
      
      
      
      <dt>Editors:</dt>
      <dd class="editor p-author h-card vcard">
    <span class="p-name fn">Remco Schaar</span> (<a class="p-org org h-org" href="https://github.com/Logius-standaarden">Logius</a>)
  </dd><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Frank van Es</span> (<a class="p-org org h-org" href="https://github.com/Logius-standaarden">Logius</a>)
  </dd><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Pieter Hering</span> (<a class="p-org org h-org" href="https://github.com/Logius-standaarden">Logius</a>)
  </dd><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Martin van der Plas</span> (<a class="p-org org h-org" href="https://github.com/Logius-standaarden">Logius</a>)
  </dd><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Alexander Green</span> (<a class="p-org org h-org" href="https://github.com/Logius-standaarden">Logius</a>)
  </dd>
      
      <dt>Authors:</dt><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Remco Schaar</span> (<a class="p-org org h-org" href="https://github.com/Logius-standaarden">Logius</a>)
  </dd><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Frank van Es</span> (<a class="p-org org h-org" href="https://github.com/Logius-standaarden">Logius</a>)
  </dd><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Joris Joosten</span> (<a class="p-org org h-org" href="https://www.vzvz.nl/">VZVZ</a>)
  </dd><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Jan Geert Koops</span> (<a class="p-org org h-org" href="https://www.dictu.nl/">Dictu</a>)
  </dd>
      <dt>Participate:</dt><dd>
    <a href="https://github.com/Logius-standaarden/OIDC-NLGOV/">GitHub Logius-standaarden/OIDC-NLGOV</a>
  </dd><dd>
    <a href="https://github.com/Logius-standaarden/OIDC-NLGOV/issues/">File an issue</a>
  </dd><dd>
    <a href="https://github.com/Logius-standaarden/OIDC-NLGOV/commits/">Commit history</a>
  </dd><dd>
    <a href="https://github.com/Logius-standaarden/OIDC-NLGOV/pulls/">Pull requests</a>
  </dd>
    </dl>
    
    
    <p>
          This document is also available in these non-normative format:
          <a rel="alternate" href="NLGov-OpenIDConnect-profile.pdf">pdf</a>
        </p>
    <p class="copyright">
          This document is licensed under 
          <a rel="license" href="https://creativecommons.org/licenses/by/4.0/legalcode" class="subfoot"><img class="license" src="https://gitdocumentatie.logius.nl/publicatie/respec/media/logos/cc-by.svg" alt="Logo Creative Commons Attribution 4.0 International Public License"><br> Creative Commons Attribution 4.0 International Public License</a>
        </p>
    <hr title="Separator for header">
  </div>
  <section id="abstract" class="introductory"><h2>Abstract</h2><p>The OpenID Connect protocol defines an identity federation system that allows
a Relying Party to request and receive authentication and profile information
about an End-User.</p>
<p>This specification profiles the OpenID Connect protocol to increase baseline
security, provide greater interoperability, and structure deployments in a
manner specifically applicable to (but not limited to) government and public
service domains in The Netherlands.</p>
<p>This profile builds on top of, and inherits all properties of, the NL GOV
Assurance profile for OAuth 2.0 [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.nlgov" title="NL GOV Assurance profile for OAuth 2.0">OAuth2.NLGov</a></cite>].</p>
</section>
  <section id="sotd" class="introductory"><h2>Status of This Document</h2><p>This is the definitive version of this document. Edits resulting from consultations have been applied.</p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#requirements-notation-and-conventions"><bdi class="secno">1.1 </bdi>Requirements Notation and Conventions</a></li><li class="tocline"><a class="tocxref" href="#terminology"><bdi class="secno">1.2 </bdi>Terminology</a></li><li class="tocline"><a class="tocxref" href="#conformance-0"><bdi class="secno">1.3 </bdi>Conformance</a></li></ol></li><li class="tocline"><a class="tocxref" href="#use-case-context"><bdi class="secno">2. </bdi>Use Case &amp; context</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#representation"><bdi class="secno">2.1 </bdi>Representation</a></li><li class="tocline"><a class="tocxref" href="#misc"><bdi class="secno">2.2 </bdi>Misc</a></li></ol></li><li class="tocline"><a class="tocxref" href="#flow"><bdi class="secno">3. </bdi>Flow</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#authorization-code-flow"><bdi class="secno">3.1 </bdi>Authorization Code Flow</a></li></ol></li><li class="tocline"><a class="tocxref" href="#openid-client-profile"><bdi class="secno">4. </bdi>OpenID Client profile</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#client-types"><bdi class="secno">4.1 </bdi>Client Types</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#web-applications"><bdi class="secno">4.1.1 </bdi>Web Applications</a></li><li class="tocline"><a class="tocxref" href="#browser-based-applications"><bdi class="secno">4.1.2 </bdi>Browser-based Applications</a></li><li class="tocline"><a class="tocxref" href="#native-and-hybrid-applications"><bdi class="secno">4.1.3 </bdi>Native and Hybrid Applications</a></li></ol></li><li class="tocline"><a class="tocxref" href="#authorization-endpoint"><bdi class="secno">4.2 </bdi>Authorization Endpoint</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#authentication-request"><bdi class="secno">4.2.1 </bdi>Authentication Request</a></li><li class="tocline"><a class="tocxref" href="#request-objects"><bdi class="secno">4.2.2 </bdi>Request Objects</a></li><li class="tocline"><a class="tocxref" href="#authentication-response-validation"><bdi class="secno">4.2.3 </bdi>Authentication Response Validation</a></li></ol></li><li class="tocline"><a class="tocxref" href="#token-endpoint"><bdi class="secno">4.3 </bdi>Token Endpoint</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#client-authentication"><bdi class="secno">4.3.1 </bdi>Client Authentication</a></li><li class="tocline"><a class="tocxref" href="#token-request"><bdi class="secno">4.3.2 </bdi>Token Request</a></li><li class="tocline"><a class="tocxref" href="#token-response-validation"><bdi class="secno">4.3.3 </bdi>Token Response Validation</a></li><li class="tocline"><a class="tocxref" href="#id-tokens"><bdi class="secno">4.3.4 </bdi>ID Tokens</a></li></ol></li><li class="tocline"><a class="tocxref" href="#discovery"><bdi class="secno">4.4 </bdi>Discovery</a></li><li class="tocline"><a class="tocxref" href="#registration"><bdi class="secno">4.5 </bdi>Registration</a></li></ol></li><li class="tocline"><a class="tocxref" href="#openid-provider-profile"><bdi class="secno">5. </bdi>OpenID Provider profile</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#authorization-endpoint-of-the-provider-profile"><bdi class="secno">5.1 </bdi>Authorization Endpoint of the Provider profile</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#request-objects-of-the-provider-profile"><bdi class="secno">5.1.1 </bdi>Request Objects of the Provider profile</a></li></ol></li><li class="tocline"><a class="tocxref" href="#token-endpoint-of-the-provider-profile"><bdi class="secno">5.2 </bdi>Token Endpoint of the Provider profile</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#token-request-validation"><bdi class="secno">5.2.1 </bdi>Token Request Validation</a></li><li class="tocline"><a class="tocxref" href="#id-tokens-of-the-provider-profile"><bdi class="secno">5.2.2 </bdi>ID Tokens of the Provider profile</a></li><li class="tocline"><a class="tocxref" href="#pairwise-identifiers"><bdi class="secno">5.2.3 </bdi>Pairwise Identifiers</a></li><li class="tocline"><a class="tocxref" href="#representation-relationships"><bdi class="secno">5.2.4 </bdi>Representation Relationships</a></li><li class="tocline"><a class="tocxref" href="#authentication-context"><bdi class="secno">5.2.5 </bdi>Authentication Context</a></li><li class="tocline"><a class="tocxref" href="#vectors-of-trust"><bdi class="secno">5.2.6 </bdi>Vectors of Trust</a></li><li class="tocline"><a class="tocxref" href="#access-tokens"><bdi class="secno">5.2.7 </bdi>Access Tokens</a></li><li class="tocline"><a class="tocxref" href="#refresh-tokens"><bdi class="secno">5.2.8 </bdi>Refresh Tokens</a></li></ol></li><li class="tocline"><a class="tocxref" href="#userinfo-endpoint"><bdi class="secno">5.3 </bdi>UserInfo Endpoint</a></li><li class="tocline"><a class="tocxref" href="#discovery-0"><bdi class="secno">5.4 </bdi>Discovery</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#discovery-endpoint"><bdi class="secno">5.4.1 </bdi>Discovery endpoint</a></li><li class="tocline"><a class="tocxref" href="#discovery-document"><bdi class="secno">5.4.2 </bdi>Discovery document</a></li><li class="tocline"><a class="tocxref" href="#caching"><bdi class="secno">5.4.3 </bdi>Caching</a></li><li class="tocline"><a class="tocxref" href="#public-keys"><bdi class="secno">5.4.4 </bdi>Public keys</a></li></ol></li><li class="tocline"><a class="tocxref" href="#dynamic-registration"><bdi class="secno">5.5 </bdi>Dynamic Registration</a></li></ol></li><li class="tocline"><a class="tocxref" href="#user-info"><bdi class="secno">6. </bdi>User Info</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#claim-interoperability"><bdi class="secno">6.1 </bdi>Claim Interoperability</a></li><li class="tocline"><a class="tocxref" href="#claims-supported"><bdi class="secno">6.2 </bdi>Claims Supported</a></li><li class="tocline"><a class="tocxref" href="#scope-profiles"><bdi class="secno">6.3 </bdi>Scope Profiles</a></li><li class="tocline"><a class="tocxref" href="#claims-request"><bdi class="secno">6.4 </bdi>Claims Request</a></li><li class="tocline"><a class="tocxref" href="#claims-response"><bdi class="secno">6.5 </bdi>Claims Response</a></li><li class="tocline"><a class="tocxref" href="#claims-metadata"><bdi class="secno">6.6 </bdi>Claims Metadata</a></li></ol></li><li class="tocline"><a class="tocxref" href="#considerations"><bdi class="secno">7. </bdi>Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#privacy-considerations"><bdi class="secno">7.1 </bdi>Privacy considerations</a></li><li class="tocline"><a class="tocxref" href="#security-considerations"><bdi class="secno">7.2 </bdi>Security considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#algorithms"><bdi class="secno">7.2.1 </bdi>Algorithms</a></li></ol></li><li class="tocline"><a class="tocxref" href="#future-updates"><bdi class="secno">7.3 </bdi>Future updates</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#service-intermediation"><bdi class="secno">7.3.1 </bdi>Service Intermediation</a></li><li class="tocline"><a class="tocxref" href="#federations"><bdi class="secno">7.3.2 </bdi>Federations</a></li><li class="tocline"><a class="tocxref" href="#other-features"><bdi class="secno">7.3.3 </bdi>Other features</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#glossary"><bdi class="secno">8. </bdi>Glossary</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#notices"><bdi class="secno">8.1 </bdi>Notices</a></li><li class="tocline"><a class="tocxref" href="#acknowledgements"><bdi class="secno">8.2 </bdi>Acknowledgements</a></li></ol></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">9. </bdi>Conformance</a></li><li class="tocline"><a class="tocxref" href="#tof"><bdi class="secno">10. </bdi>List of Figures</a></li><li class="tocline"><a class="tocxref" href="#index"><bdi class="secno">A. </bdi>Index</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#index-defined-here"><bdi class="secno">A.1 </bdi>Terms defined by this specification</a></li><li class="tocline"><a class="tocxref" href="#index-defined-elsewhere"><bdi class="secno">A.2 </bdi>Terms defined by reference</a></li></ol></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">B. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">B.1 </bdi>Normative references</a></li><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">B.2 </bdi>Informative references</a></li></ol></li></ol></nav><section id="introduction"><div class="header-wrapper"><h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction</h2><a class="self-link" href="#introduction" aria-label="Permalink for Section 1."></a></div>
<p>Government regulations for permitting users (citizens and non-citizens) online access to government resources vary greatly from country to country. There is a strong desire to leverage federated authentication and identity services for public access to government resources online to enable the development of safe and innovative applications for e-government services, increase overall account security, reduce cost, and provide reliable identity assurances from established and trusted sources when applicable.</p>
<p>OpenID Connect is a protocol enabling such federated identity and authentication protocol. OpenID Connect supports a variety of Use Cases and offers a range of features and (security) options. This specification aims to define an OpenID Connect profile that provides Dutch governments with a foundation for securing federated access to public services online when applying OpenID Connect.</p>
<section id="requirements-notation-and-conventions"><div class="header-wrapper"><h3 id="x1-1-requirements-notation-and-conventions"><bdi class="secno">1.1 </bdi>Requirements Notation and Conventions</h3><a class="self-link" href="#requirements-notation-and-conventions" aria-label="Permalink for Section 1.1"></a></div>
<p>The key words "<em class="rfc2119">MUST</em>", "<em class="rfc2119">MUST NOT</em>", "<em class="rfc2119">REQUIRED</em>", "<em class="rfc2119">SHALL</em>", "<em class="rfc2119">SHALL NOT</em>", "<em class="rfc2119">SHOULD</em>", "<em class="rfc2119">SHOULD NOT</em>", "<em class="rfc2119">RECOMMENDED</em>", "<em class="rfc2119">NOT RECOMMENDED</em>", "<em class="rfc2119">MAY</em>", and "<em class="rfc2119">OPTIONAL</em>" in this document are to be interpreted as described in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>].</p>
<p>All uses of "<abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> Web Signature (<abbr title="JSON Web Signature">JWS</abbr>)" [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7515" title="JSON Web Signature (JWS)">RFC7515</a></cite>] and "<abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> Web Encryption (<abbr title="JSON Web Encryption">JWE</abbr>)" [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7516" title="JSON Web Encryption (JWE)">RFC7516</a></cite>] data structures in this specification utilize the <abbr title="JSON Web Signature">JWS</abbr> Compact Serialization or the <abbr title="JSON Web Encryption">JWE</abbr> Compact Serialization; the <abbr title="JSON Web Signature">JWS</abbr> <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> Serialization and the <abbr title="JSON Web Encryption">JWE</abbr> <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> Serialization are not used.</p>
</section><section id="terminology"><div class="header-wrapper"><h3 id="x1-2-terminology"><bdi class="secno">1.2 </bdi>Terminology</h3><a class="self-link" href="#terminology" aria-label="Permalink for Section 1.2"></a></div>
<p>This specification uses the following terms:</p>
<ul>
<li>"Access Token", "Authorization Code", "Authorization Endpoint", "Authorization Grant", "Authorization Server", "Client", "Client Authentication", "Client Identifier", "Client Secret", "Grant Type", "Protected Resource", "Redirection <abbr title="Uniform Resource Identifier">URI</abbr>", "Refresh Token", "Resource Server", "Response Type", and "Token Endpoint" defined by 'OAuth 2.0' [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6749" title="The OAuth 2.0 Authorization Framework">RFC6749</a></cite>];</li>
<li>"Claim Name", "Claim Value", and "<abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> Web Token (<abbr title="JSON Web Token">JWT</abbr>)" defined by '<abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> Web Token (<abbr title="JSON Web Token">JWT</abbr>)' [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7519" title="JSON Web Token (JWT)">RFC7519</a></cite>];</li>
<li>"Introspection Endpoint" defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7662" title="OAuth 2.0 Token Introspection">RFC7662</a></cite>];</li>
<li>"Revocation Endpoint" defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7009" title="OAuth 2.0 Token Revocation">RFC7009</a></cite>];</li>
<li>"Browser-based application" defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.browser-based-apps" title="OAuth 2.0 for Browser-Based Apps">OAuth2.Browser-Based-Apps</a></cite>];</li>
<li>"Native app", "Hybrid app", "External user-agent", "Embedded user-agent", "In-app browser tab", "Web-view", "Claimed 'https' scheme <abbr title="Uniform Resource Identifier">URI</abbr>", "Private-use <abbr title="Uniform Resource Identifier">URI</abbr> scheme" defined by 'OAuth 2.0 for Native Apps' [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8252" title="OAuth 2.0 for Native Apps">RFC8252</a></cite>];</li>
<li>"User-agent" defined by 'Hypertext Transfer Protocol' [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2616" title="Hypertext Transfer Protocol -- HTTP/1.1">RFC2616</a></cite>]; and</li>
<li>the terms defined by 'OpenID Connect Core 1.0' [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>].</li>
</ul>
<p>In addition to the above terminology, this profile defines the following terms:</p>
<ul>
<li>"Representation", "Representation Relationship", "<abbr title="Electronic Identification, Authentication and Trust Services">eIDAS</abbr>".</li>
</ul>
<p>Definitions for these terms as well as for the abbreviations used throughout this specification are listed in the Glossary.</p>
</section><section id="conformance-0"><div class="header-wrapper"><h3 id="x1-3-conformance"><bdi class="secno">1.3 </bdi>Conformance</h3><a class="self-link" href="#conformance-0" aria-label="Permalink for Section 1.3"></a></div>
<p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p>
<p>This profile is based upon the 'International Government Assurance Profile (iGov) for OpenID Connect 1.0' [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.igov" title="International Government Assurance Profile (iGov) for OpenID Connect 1.0">OpenID.iGov</a></cite>] as published by the <a href="https://openid.net/foundation/">OpenID Foundation</a>. It should be considered a fork of this profile, as the iGov profile is geared more towards a United States context and this NL GOV profile towards a Dutch context with European Union regulations applicable.</p>
<p>This specification defines requirements for the following components:</p>
<ul>
<li>OpenID Connect 1.0 Relying Parties (also known as OpenID Clients, or <abbr title="Relying Party">RP</abbr>)</li>
<li>OpenID Connect 1.0 Identity Providers (also known as OpenID Providers, <abbr title="Identity Provider">IdP</abbr> or <abbr title="OpenID Provider">OP</abbr>)</li>
</ul>
<p>The specification also defines features for interaction between these components:</p>
<ul>
<li>Relying Party to Identity Provider</li>
</ul>
<p>When an NL GOV-compliant component is interacting with other NL GOV-compliant components, in any valid combination, all components <em class="rfc2119">MUST</em> fully conform to the features and requirements of this specification. All interaction with non-NL GOV components is outside the scope of this specification.</p>
<p>An NL GOV-compliant OpenID Connect Identity Provider <em class="rfc2119">MUST</em> support all features as described in this specification. A general-purpose Identity Provider <em class="rfc2119">MAY</em> support additional features for use with non-NL GOV Clients.</p>
<p>An NL GOV-compliant OpenID Connect Identity Provider <em class="rfc2119">MAY</em> also provide NL GOV-compliant OAuth 2.0 Authorization Server functionality. In such cases, the Authorization Server <em class="rfc2119">MUST</em> fully implement the NL GOV Assurance profile for OAuth 2.0 [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.nlgov" title="NL GOV Assurance profile for OAuth 2.0">OAuth2.NLGov</a></cite>]. If an NL GOV-compliant OpenID Connect Identity Provider does not provide NL GOV-compliant OAuth 2.0 Authorization Server services, all features related to interaction between the Authorization Server and protected resource are <em class="rfc2119">OPTIONAL</em>.</p>
<p>An NL GOV-compliant OpenID Connect Client <em class="rfc2119">MUST</em> support all required functionality described in this specification. A general-purpose Client library <em class="rfc2119">MAY</em> support additional features for use with non-NL GOV OpenID Connect Identity Providers.</p>
</section></section><section id="use-case-context"><div class="header-wrapper"><h2 id="x2-use-case-context"><bdi class="secno">2. </bdi>Use Case &amp; context</h2><a class="self-link" href="#use-case-context" aria-label="Permalink for Section 2."></a></div>
<p>This profile supports several Use Cases or partial aspects thereof. Design choices within this profile have been made with these Use Cases under consideration.</p>
<p>The generic Use Case is an End-User with the intention to consume an online service of a Service Provider. As the service requires authentication, this triggers the authentication process.</p>
<p>Authentication is provided in a federated manner. In other words, a Client system is relying upon another system, the OpenID Provider, for authentication.
Either a shared central OpenID Provider or a (distributed) network of OpenID Providers, a.k.a. a federation or scheme is being used. The ecosystem supported by the OpenID Provider can either be a single organization (intra-organizational) or multiple organizations (inter-organizational), through either bilateral or multilateral agreements.
In case a federation or scheme is being used, an Identity Broker may be applicable. Although this profile allows for usage in a federation, no explicit support for federations is <em>currently</em> included.</p>
<p>The service is offered by a (semi-)governmental or public Service Provider. The Use Cases therefore explicitly covers Citizen-to-Government as well as Business-to-Government contexts. Note that business-to-government is not strictly limited to businesses, these may be other governmental organisations (inter-organizational) or internal service consumers (intra-organisational). This profile is not limited to these contexts, nor intended to exclude Business-to-Consumer and Business-to-Business contexts, but additional considerations may be applicable in those contexts.</p>
<p>The Service Provider or OpenID Client requests either an identifier, attributes or both of an authenticated End-User from the OpenID Provider. As target End-User audiences are diverse, multiple types of identifiers can be supported. Supported Use Cases therefore span both identifiale and attribute-based authentication.</p>
<p>From an architectual standpoint, the Use Case can utilize a Client in the form of a hosted web-application, a mobile/native application or a browser based single-page-application (SPA). See <a href="#client-types">Section 4.1 Client Types</a> for more details.</p>
<section id="representation"><div class="header-wrapper"><h3 id="x2-1-representation"><bdi class="secno">2.1 </bdi>Representation</h3><a class="self-link" href="#representation" aria-label="Permalink for Section 2.1"></a></div>
<p>This profile supports several Use Cases for Representation Relationships, which apply when an End-User intends to consume an online service on behalf of a Natural or Juridical Person (the service consumer), where authentication and authorization is required. The End-User in these Use Cases is a Natural Person, representing the service consumer through a Representation Relationship. The relationship has to be formalized and may be either a direct relationship, either voluntarily or on legal grounds, or a chain of Representation Relationships. The formalization of these relationships is out of scope of this profile.</p>
<p>Example Representation Use Cases include voluntary authorization, representative assigned by court order (guardian, administrator), statutory signatory (director, president), limited authorized signatory, etc.</p>
</section><section id="misc"><div class="header-wrapper"><h3 id="x2-2-misc"><bdi class="secno">2.2 </bdi>Misc</h3><a class="self-link" href="#misc" aria-label="Permalink for Section 2.2"></a></div>
<p>The OpenID Connect specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>] supports self-issued OpenID Connect Providers. However, as this profile centers around (semi-)governmental and public domain Use Cases where assurance on identity verification is virtually always required, self-issued OpenID Providers <em class="rfc2119">MUST NOT</em> be accepted by OpenID Clients under this profile.</p>
<p>As the Dutch identity eco-system supports multiple OpenID Providers, Identity Brokers are in common use. Brokers relieve OpenID Clients of managing multiple connections to OpenID Providers, but every additional step introduces security risks and concern with regards to privacy. Among the privacy concerns is the forming of so-called privacy hotspots, points were data collection can be concentrated.
To mitigate such risks, end-to-end security is considered throughout this profile. Controls such as signing, to assure integrity, and encryption, to strengthen confidentiality, are encouraged to increase overall end-to-end security.</p>
<blockquote>
<p>Note that future versions of this profile may support use cases where Service Intermediation is applicable.</p>
</blockquote>
</section></section><section id="flow"><div class="header-wrapper"><h2 id="x3-flow"><bdi class="secno">3. </bdi>Flow</h2><a class="self-link" href="#flow" aria-label="Permalink for Section 3."></a></div>
<p>OpenID Connect Core specifies three paths via which authentication can be performed: the <em>Authorization Code Flow</em>, the <em>Implicit Flow</em> and the <em>Hybrid Flow</em>. The flows determine how the ID Token and Access Token are returned to the Client.</p>
<p>This profile requires that authentication is performed using the Authorization Code Flow, in where all tokens are returned from the Token Endpoint.</p>
<p>The Implicit Flow and Hybrid Flow allow tokens to be obtained from the Authorization Endpoint, and thereby omitting the Token endpoint. This  makes them vulnerable to token leakage and token replay and makes it impossible to cryptographically bind tokens to a certain Client.</p>
<p>Therefore, the Implicit Flow and Hybrid flow <em class="rfc2119">MUST NOT</em> be used. Also, the <abbr title="Internet Engineering Task Force">IETF</abbr> OAuth Working Group is removing support for the Implicit Flow from the OAuth 2.1 specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.1" title="OAuth 2.1 Working draft">OAuth2.1</a></cite>] for the same reasons.</p>
<section id="authorization-code-flow"><div class="header-wrapper"><h3 id="x3-1-authorization-code-flow"><bdi class="secno">3.1 </bdi>Authorization Code Flow</h3><a class="self-link" href="#authorization-code-flow" aria-label="Permalink for Section 3.1"></a></div>
<p>The Authorization Code Flow returns an Authorization Code to the Client, which can then exchange it for an ID Token and an Access Token directly. The flow comprises the following steps:</p>
<ol>
<li>The Client sends an Authorization Request - containing the desired request parameters - to the OpenID Provider.</li>
<li>The OpenID Provider authenticates the End-User.</li>
<li>The OpenID Provider sends the End-User back to the Client with an Authorization Code.</li>
<li>The Client requests a response using the Authorization Code at the Token Endpoint.</li>
<li>The Client receives a response that contains an ID Token and Access Token in the response body.</li>
<li>The Client validates the ID token and retrieves Claims and Subject Identifier(s) of the authenticated End-User.</li>
</ol>
<p>The flow described by these steps is illustrated as follows:</p>
<figure id="authorization_code_flow">
  <img src="media/authorization-code-flow.png" alt="authorization code flow" width="479">
  <figcaption><a class="self-link" href="#authorization_code_flow">Figure <bdi class="figno">1</bdi></a> <span class="fig-title">Authorization Code Flow</span></figcaption>

</figure></section></section><section id="openid-client-profile"><div class="header-wrapper"><h2 id="x4-openid-client-profile"><bdi class="secno">4. </bdi>OpenID Client profile</h2><a class="self-link" href="#openid-client-profile" aria-label="Permalink for Section 4."></a></div>
<section id="client-types"><div class="header-wrapper"><h3 id="x4-1-client-types"><bdi class="secno">4.1 </bdi>Client Types</h3><a class="self-link" href="#client-types" aria-label="Permalink for Section 4.1"></a></div>
<p>OAuth 2.0 defines two Client Types (<em>confidential</em> and <em>public</em> Clients) and three Client Profiles (<em>Web Applications</em>, <em>Browser / User-Agent based Applications</em>, and <em>Native Applications</em>).</p>
<p>This profile includes specific design considerations related to security and platform capabilities for these different Client Types and Profiles.</p>
<blockquote>
<p><strong>Note:</strong> The iGov and NL GOV Assurance profiles for OAuth 2.0 use a slightly different segregation of Client Types: <em>Full Clients</em> and <em>Native Clients</em> act on behalf of a End-User and <em>Direct Access Clients</em> act on behalf of themselves (e.g. those Clients that facilitate bulk transfers). <em>Direct Access Clients</em> are out of scope for this profile; <em>Full Clients</em> and <em>Native Clients</em> are treated as <em>Web applications</em> and <em>Native applications</em> respectively. This profile follows the OAuth 2.0 specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6749" title="The OAuth 2.0 Authorization Framework">RFC6749</a></cite>] instead, as it allows for better provisioning of specific security considerations specific to the different Client types and it aligns better to the Security Best Practices for the different Client profiles.</p>
</blockquote>
<p>The following design considerations apply to all Clients:</p>
<ul>
<li>Clients <em class="rfc2119">MUST</em> use 'Proof Key for Code Exchange' [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7636" title="Proof Key for Code Exchange by OAuth Public Clients">RFC7636</a></cite>] to protect calls to the Token Endpoint.</li>
<li>Clients <em class="rfc2119">SHOULD</em> restrict its Client-Side script (e.g. JavaScript) execution to a set of statically hosted scripts via a 'Content Security Policy' [<cite><a class="bibref" data-link-type="biblio" href="#bib-csp" title="Content Security Policy Level 3">CSP</a></cite>].</li>
<li>Clients <em class="rfc2119">SHOULD</em> use 'Subresource Integrity' [<cite><a class="bibref" data-link-type="biblio" href="#bib-sri" title="Subresource Integrity">SRI</a></cite>] to verify that any dependencies they include (e.g. via a Content Delivery Network) are not unexpectedly manipulated.</li>
</ul>
<section id="web-applications"><div class="header-wrapper"><h4 id="x4-1-1-web-applications"><bdi class="secno">4.1.1 </bdi>Web Applications</h4><a class="self-link" href="#web-applications" aria-label="Permalink for Section 4.1.1"></a></div>
<p><em>Web applications</em> are applications that run on a web server and are consumed through the user-agent ("browser") by the End-User. Web applications are capable of securely authenticating themselves and of maintaining the confidentiality of secrets (e.g. Client credentials and tokens) and are therefore considered <em>confidential</em> Clients (OAuth 2.0 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6749" title="The OAuth 2.0 Authorization Framework">RFC6749</a></cite>], Section 2.1).</p>
</section><section id="browser-based-applications"><div class="header-wrapper"><h4 id="x4-1-2-browser-based-applications"><bdi class="secno">4.1.2 </bdi>Browser-based Applications</h4><a class="self-link" href="#browser-based-applications" aria-label="Permalink for Section 4.1.2"></a></div>
<p><em>Browser-based applications</em> are applications that are dynamically downloaded and executed in a web browser that are also sometimes referred to as <em>user-agent-based applications</em> or <em>single-page applications</em>. Browser-based applications are considered to be not capable of maintaining the confidentiality of secrets, as they may be vulnerable to several types of attacks, including Cross-Site Scripting (<abbr title="Cross-Site Scripting">XSS</abbr>), Cross Site Request Forgery (<abbr title="Cross Site Request Forgery">CSRF</abbr>) and OAuth token theft. Browser-based applications are considered <em>public</em> Clients (OAuth 2.0 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6749" title="The OAuth 2.0 Authorization Framework">RFC6749</a></cite>], Section 2.1).</p>
<ul>
<li>Browser-based applications <em class="rfc2119">SHOULD</em> follow the best practices specified in [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.browser-based-apps" title="OAuth 2.0 for Browser-Based Apps">OAuth2.Browser-Based-Apps</a></cite>].</li>
</ul>
</section><section id="native-and-hybrid-applications"><div class="header-wrapper"><h4 id="x4-1-3-native-and-hybrid-applications"><bdi class="secno">4.1.3 </bdi>Native and Hybrid Applications</h4><a class="self-link" href="#native-and-hybrid-applications" aria-label="Permalink for Section 4.1.3"></a></div>
<p><em>Native applications</em> are applications installed and executed on the device used by the End-User (i.e. desktop applications, native mobile applications). Native applications can sufficiently protect dynamically issued secrets, but are not capable of maintaining the confidentiality of secrets that are statically included as part of an app distribution. Therefore, Native applications are considered <em>public</em> Clients, except when they are provisioned per-instance secrets via mechanisms like Dynamic Client Registration (OAuth 2.0 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6749" title="The OAuth 2.0 Authorization Framework">RFC6749</a></cite>], Section 2.1).</p>
<p><em>Hybrid applications</em> are applications implemented using web-based technology but distributed as a native app; these are considered equivalent to native applications for the purpose of this profile.</p>
<ul>
<li>Native applications <em class="rfc2119">MUST</em> follow the best practices as specified in OAuth 2.0 for Native Apps [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8252" title="OAuth 2.0 for Native Apps">RFC8252</a></cite>].</li>
<li>The use of <em>confidential</em> Native applications (which are provisioned per-instance secrets) is <em class="rfc2119">RECOMMENDED</em> over <em>public</em> Native applications, as <em>confidential</em> Clients provide better means to perform secure Client Authentication.</li>
<li>Native applications <em class="rfc2119">MUST</em> use an external user-agent or "in-app browser tab" to make authorization requests; an "embedded user-agent" or "web-view" components <em class="rfc2119">MUST NOT</em> be used for this purpose. See 'OAuth 2.0 for Native apps' [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8252" title="OAuth 2.0 for Native Apps">RFC8252</a></cite>] for more information on the "in-app browser tab" feature and support on various platforms.</li>
</ul>
</section></section><section id="authorization-endpoint"><div class="header-wrapper"><h3 id="x4-2-authorization-endpoint"><bdi class="secno">4.2 </bdi>Authorization Endpoint</h3><a class="self-link" href="#authorization-endpoint" aria-label="Permalink for Section 4.2"></a></div>
<section id="authentication-request"><div class="header-wrapper"><h4 id="x4-2-1-authentication-request"><bdi class="secno">4.2.1 </bdi>Authentication Request</h4><a class="self-link" href="#authentication-request" aria-label="Permalink for Section 4.2.1"></a></div>
<p>The following describes the supported OpenID Connect Authorization Code Flow parameters for use with a NL Gov compatible OpenID Provider.
Some of these requirements are inherited as specified in Section 2.1.1 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.nlgov" title="NL GOV Assurance profile for OAuth 2.0">OAuth2.NLGov</a></cite>].</p>
<p>Request Parameters:</p>
<p><code>client_id</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. Valid OAuth 2.0 Client Identifier. <em class="rfc2119">MUST</em> have the value as obtained during registration. Identical as in [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.nlgov" title="NL GOV Assurance profile for OAuth 2.0">OAuth2.NLGov</a></cite>].</li>
</ul>
<p><code>response_type</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. <em class="rfc2119">MUST</em> have value <code>code</code> for the Authorization Code Flow. Identical as in [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.nlgov" title="NL GOV Assurance profile for OAuth 2.0">OAuth2.NLGov</a></cite>].</li>
</ul>
<p><code>scope</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. Indicates the access privileges being requested. <em class="rfc2119">MUST</em> contain at least the value <code>openid</code> and <em class="rfc2119">SHOULD</em> contain a specific scope for which access is requested.</li>
</ul>
<p><code>redirect_uri</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. Indicates a valid endpoint where the Client will receive the authentication response. <em class="rfc2119">MUST</em> be an absolute HTTPS URL unless the Client is a native application operating on a desktop device. In case of a native application on a desktop, this <em class="rfc2119">MAY</em> be an absolute HTTP URL with the literal loopback IP address and port number the Client is listening on as hostname. <em class="rfc2119">MUST NOT</em> use <code>localhost</code> for loopback addresses, see [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8252" title="OAuth 2.0 for Native Apps">RFC8252</a></cite>] Sections 7.3 and 8.3. <em class="rfc2119">MUST</em> exactly match one of the Redirection <abbr title="Uniform Resource Identifier">URI</abbr> values for the Client pre-registered at the OpenID Provider, except for the port <abbr title="Uniform Resource Identifier">URI</abbr> component on loopback addresses for native applications on desktops. Inter-app redirect URIs for Native applications on mobile devices <em class="rfc2119">MUST</em> use Claimed <code>https</code> Scheme <abbr title="Uniform Resource Identifier">URI</abbr> Redirection, as specified in Section 7.2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8252" title="OAuth 2.0 for Native Apps">RFC8252</a></cite>].</li>
</ul>
<p><code>state</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. Unguessable random string generated by the Client, used to protect against Cross-Site Request Forgery (<abbr title="Cross Site Request Forgery">CSRF</abbr>, XSRF) attacks. Must contain at least 128 bits of cryptographic random to avoid guessing. Returned to the Client in the Authentication Response. Identical as in [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.nlgov" title="NL GOV Assurance profile for OAuth 2.0">OAuth2.NLGov</a></cite>].</li>
</ul>
<p><code>nonce</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. Unguessable random string generated by the Client, used to associate a Client session with an ID Token and to protect against replay attacks. Must contain at least 128 bits of cryptographic random to avoid guessing. Returned to the Client in the ID Token. See also [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>], Section 15.5.2 for implementation notes.</li>
</ul>
<p><code>acr_values</code></p>
<ul>
<li><em class="rfc2119">OPTIONAL</em>. Lists the acceptable LoAs for this authentication. Under this profile, <code>acr_values</code> takes precedence over <code>vtr</code>. See also <a href="#authentication-context">Section 5.2.3</a>. Identical as in [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>].</li>
</ul>
<p><code>vtr</code></p>
<ul>
<li><em class="rfc2119">OPTIONAL</em>. <em class="rfc2119">MUST</em> be set to a value as described in Section 6.1 of Vectors of Trust [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8485" title="Vectors of Trust">RFC8485</a></cite>]. <em class="rfc2119">MUST NOT</em> be used when <code>acr_values</code> is set or when the <code>acr</code> Claim is requested via the <code>claims</code> parameter. See also <a href="#vectors-of-trust">Section 5.2.4</a>.</li>
</ul>
<p><code>claims</code></p>
<ul>
<li><em class="rfc2119">OPTIONAL</em>. This parameter is used to request specific Claims. The value is a <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> object listing the requested Claims, as specified in section 5.5 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>].</li>
</ul>
<p><code>code_challenge</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. Code challenge as in <abbr title="Proof Key for Code Exchange">PKCE</abbr> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7636" title="Proof Key for Code Exchange by OAuth Public Clients">RFC7636</a></cite>].</li>
</ul>
<p><code>code_challenge_method</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. <em class="rfc2119">MUST</em> use the value of <code>S256</code>.</li>
</ul>
<aside class="example" id="example-1"><div class="marker">
    <a class="self-link" href="#example-1">Example<bdi> 1</bdi></a>
  </div>
A sample request may look like:
  <pre aria-busy="false"><code class="hljs javascript">https:<span class="hljs-comment">//idp-p.example.com/authorize?</span>
client_id=55f9f559-<span class="hljs-number">2496</span>-49d4-b6c3-351a586b7484
&amp;nonce=cd567ed4d958042f721a7cdca557c30d
&amp;response_type=code
&amp;scope=openid+email
&amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
&amp;state=481e9c0c52e751a120fd90f7f4b5a637
&amp;acr_values=http%3a%2f%2feidas.europa.eu%2fLoA%2fsubstantial
&amp;code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM
&amp;code_challenge_method=S256</code></pre>
</aside>

</section><section id="request-objects"><div class="header-wrapper"><h4 id="x4-2-2-request-objects"><bdi class="secno">4.2.2 </bdi>Request Objects</h4><a class="self-link" href="#request-objects" aria-label="Permalink for Section 4.2.2"></a></div>
<p>Clients <em class="rfc2119">MAY</em> optionally send requests to the Authorization Endpoint using the <code>request</code> or <code>request_uri</code> parameter as defined by OpenID Connect [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>], section 6.
Passing a Request Object by reference using the <code>request_uri</code> is preferred because of browser limits and network latency.</p>
<p>Request Objects <em class="rfc2119">MUST</em> be signed by the Client's registered key. Request Objects <em class="rfc2119">MAY</em> be encrypted to the OpenID Provider's public key. When sending Request Objects by reference, Clients <em class="rfc2119">MUST</em> pre-register <code>request_uri</code> values with the OpenID Provider at registration and <em class="rfc2119">MUST</em> only use pre-registered values for <code>request_uri</code>.</p>
</section><section id="authentication-response-validation"><div class="header-wrapper"><h4 id="x4-2-3-authentication-response-validation"><bdi class="secno">4.2.3 </bdi>Authentication Response Validation</h4><a class="self-link" href="#authentication-response-validation" aria-label="Permalink for Section 4.2.3"></a></div>
<p>All Clients <em class="rfc2119">MUST</em> validate the following in received Authentication Responses:</p>
<p><code>state</code></p>
<ul>
<li>The <code>state</code> response parameter <em class="rfc2119">MUST</em> be present and <em class="rfc2119">MUST</em> equal the <code>state</code> request parameter sent in the Authentication Request.</li>
</ul>
<p>This in line with OpenID Connect Core ([<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>], Section 3.1.2.7), which equals to OAuth 2.0 ([<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6749" title="The OAuth 2.0 Authorization Framework">RFC6749</a></cite>], Section 4.1.2 and 10.12). Verifying the <code>state</code> returned in the Authorization Response is part of <abbr title="Cross Site Request Forgery">CSRF</abbr> mitigation measures and will help prevent attacks with late or stale responses, among others.</p>
</section></section><section id="token-endpoint"><div class="header-wrapper"><h3 id="x4-3-token-endpoint"><bdi class="secno">4.3 </bdi>Token Endpoint</h3><a class="self-link" href="#token-endpoint" aria-label="Permalink for Section 4.3"></a></div>
<section id="client-authentication"><div class="header-wrapper"><h4 id="x4-3-1-client-authentication"><bdi class="secno">4.3.1 </bdi>Client Authentication</h4><a class="self-link" href="#client-authentication" aria-label="Permalink for Section 4.3.1"></a></div>
<p>Confidential Clients, as defined in <a href="#client-types">Section 4.1</a>, <em class="rfc2119">MUST</em> authenticate to the OpenID Provider using either:</p>
<ul>
<li>a <abbr title="JSON Web Token">JWT</abbr> assertion as defined by the '<abbr title="JSON Web Token">JWT</abbr> Profile for OAuth 2.0 Client Authentication and Authorization Grants' [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7523" title="JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants">RFC7523</a></cite>] using only the <code>private_key_jwt</code> method defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>]; or</li>
<li>mutually authenticated TLS, as specified in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8705" title="OAuth 2.0 Mutual-TLS Client Authentication and Certificate-Bound Access Tokens">RFC8705</a></cite>]. In case of a mutual TLS connection (mTLS) between the Client and the server, the <abbr title="JSON Web Token">JWT</abbr> assertion <em class="rfc2119">SHOULD</em> be omitted and the <code>client_id</code> parameter <em class="rfc2119">MUST</em> be included.</li>
</ul>
<p>Public Clients <em class="rfc2119">MAY</em> authenticate to the OpenID Provider. However, the OpenID Provider <em class="rfc2119">MUST NOT</em> rely on public Client Authentication for the purpose of identifying the Client.</p>
<p>Clients <em class="rfc2119">MUST NOT</em> use more than one authentication method in each request.</p>
</section><section id="token-request"><div class="header-wrapper"><h4 id="x4-3-2-token-request"><bdi class="secno">4.3.2 </bdi>Token Request</h4><a class="self-link" href="#token-request" aria-label="Permalink for Section 4.3.2"></a></div>
<p>The following describes the supported parameters for the Token Request. Some of these requirements are inherited as specified in Section 2.3.1 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.nlgov" title="NL GOV Assurance profile for OAuth 2.0">OAuth2.NLGov</a></cite>].</p>
<p>The following parameters are specified:</p>
<p><code>grant_type</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. <em class="rfc2119">MUST</em> contain the value <code>authorization_code</code>. Identical as in [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.nlgov" title="NL GOV Assurance profile for OAuth 2.0">OAuth2.NLGov</a></cite>].</li>
</ul>
<p><code>code</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. The value of the <code>code</code> parameter returned in the Authorization Response. Clients <em class="rfc2119">MUST NOT</em> use the same authorization code more than once. Identical as in [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.nlgov" title="NL GOV Assurance profile for OAuth 2.0">OAuth2.NLGov</a></cite>].</li>
</ul>
<p><code>client_assertion</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>, in case <code>private_key_jwt</code> is used for Client Authentication. The value of the signed Client Authentication <abbr title="JSON Web Token">JWT</abbr> generated as described in [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.nlgov" title="NL GOV Assurance profile for OAuth 2.0">OAuth2.NLGov</a></cite>]. The OpenID Client <em class="rfc2119">MUST</em> generate a new assertion <abbr title="JSON Web Token">JWT</abbr> for each call to the Token Endpoint.</li>
</ul>
<p><code>client_assertion_type</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>, in case <code>client_assertion</code> is present. <em class="rfc2119">MUST</em> be set to <code>urn:ietf:params:oauth:client-assertion-type:jwt-bearer</code>.</li>
</ul>
<p><code>client_id</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>, in case mutually authenticated TLS is used for Client Authentication.</li>
</ul>
<p><code>code_verifier</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. Code verifier as in <abbr title="Proof Key for Code Exchange">PKCE</abbr> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7636" title="Proof Key for Code Exchange by OAuth Public Clients">RFC7636</a></cite>].</li>
</ul>
</section><section id="token-response-validation"><div class="header-wrapper"><h4 id="x4-3-3-token-response-validation"><bdi class="secno">4.3.3 </bdi>Token Response Validation</h4><a class="self-link" href="#token-response-validation" aria-label="Permalink for Section 4.3.3"></a></div>
<p>All Clients <em class="rfc2119">MUST</em> validate the following in received Token Responses:</p>
<ul>
<li>Follow the Token Response validation rules in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6749" title="The OAuth 2.0 Authorization Framework">RFC6749</a></cite>], Sections 5.1 and 10.12.</li>
<li>Validate the Access Token according to [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>], Section 3.1.3.8.</li>
<li>Validate the ID Token according to [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>], Section 3.1.3.7, as well as the below mentioned requirements for validating the ID Token.</li>
</ul>
<p>This in line with [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>], Section 3.1.3.5.</p>
</section><section id="id-tokens"><div class="header-wrapper"><h4 id="x4-3-4-id-tokens"><bdi class="secno">4.3.4 </bdi>ID Tokens</h4><a class="self-link" href="#id-tokens" aria-label="Permalink for Section 4.3.4"></a></div>
<p>All Clients <em class="rfc2119">MUST</em> validate the signature of an ID Token before accepting it. Validation can be done using the public key of the issuing server, which is published in <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> Web Key (JWK) format. ID Tokens <em class="rfc2119">MAY</em> be encrypted using the appropriate key of the requesting Client.</p>
<p>Clients <em class="rfc2119">MUST</em> verify the following in received ID tokens:</p>
<p><code>iss</code></p>
<ul>
<li>The <code>issuer</code> Claim is the Uniform Resource Locater (URL) of the expected Issuer. Identical as in [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.igov" title="International Government Assurance Profile (iGov) for OpenID Connect 1.0">OpenID.iGov</a></cite>].</li>
</ul>
<p><code>aud</code></p>
<ul>
<li>The <code>audience</code> Claim contains the Client ID of the Client. Identical as in [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.igov" title="International Government Assurance Profile (iGov) for OpenID Connect 1.0">OpenID.iGov</a></cite>].</li>
</ul>
<p><code>nonce</code></p>
<ul>
<li>The <code>nonce</code> parameter in the ID Token <em class="rfc2119">MUST</em> equal the <code>nonce</code> request parameter sent in the Authentication Request. This is in line with [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>], Section 3.1.3.7.</li>
</ul>
<p><code>exp</code>, <code>iat</code>, <code>nbf</code></p>
<ul>
<li>The <code>expiration</code>, <code>issued at</code>, and <code>not before</code> timestamps for the token are within acceptable ranges. These Claims are formatted as Unix Time Stamps (number of seconds since 1970-01-01T00:00:00Z UTC). Values for <code>iat</code> and <code>nbf</code> <em class="rfc2119">MUST</em> lie in the past and <code>exp</code> <em class="rfc2119">MUST</em> lie in the future; the acceptable range for how far away <code>iat</code> is in the past is specific to the Client. This is in line with [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.igov" title="International Government Assurance Profile (iGov) for OpenID Connect 1.0">OpenID.iGov</a></cite>].</li>
</ul>
<p><code>acr</code></p>
<ul>
<li>The Level of Assurance received in the <code>acr</code> Claim is at least the Level of Assurance requested. See also <a href="#authentication-context">Section 5.2.3</a>. This is in line with [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>], Section 3.1.3.7.</li>
</ul>
<p><code>represents</code></p>
<ul>
<li>The <code>represents</code> Claim, if applicable, identifies the represented service consumer on behalf of which the End-User intends to authenticate. Any Client <em class="rfc2119">MUST</em> be able to process <code>represents</code> Claims. As an exception, <code>represents</code> Claims <em class="rfc2119">MAY</em> be ignored by the Client if, and only if, it is explicitly agreed upon beforehand that no Representation will be provided.</li>
</ul>
</section></section><section id="discovery"><div class="header-wrapper"><h3 id="x4-4-discovery"><bdi class="secno">4.4 </bdi>Discovery</h3><a class="self-link" href="#discovery" aria-label="Permalink for Section 4.4"></a></div>
<p>All Clients <em class="rfc2119">SHOULD</em> use OpenID Provider discovery to avoid manual configuration and risk of mistakes.</p>
<p>Clients <em class="rfc2119">SHOULD</em> acquire OpenID Provider metadata using either 'OpenID Connect Discovery 1.0' ([<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.discovery" title="OpenID Connect Discovery 1.0">OpenID.Discovery</a></cite>] Section 4) or 'OAuth 2.0 Authorization Server Metadata' ([<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8414" title="OAuth 2.0 Authorization Server Metadata">RFC8414</a></cite>] Section 3) via one of the Discovery endpoints provided by the OpenID Provider. See also Section <a href="#discovery">5.4</a>.</p>
<p>Clients <em class="rfc2119">SHOULD NOT</em> use OpenID Provider Issuer Discover using WebFinger (as described in [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>], Section 2) to avoid privacy issues such as leaking information to unknown locations.</p>
<p>Clients <em class="rfc2119">SHOULD</em> follow caching directives provided by the OpenID Provider via HTTP headers [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7234" title="Hypertext Transfer Protocol (HTTP/1.1): Caching">RFC7234</a></cite>] for the OpenID Provider's Discovery and <code>jwks</code> endpoints. This to avoid having to unnecessarily re-retrieve these documents while getting fresh updates of these documents when they have changed.</p>
<p>Clients <em class="rfc2119">SHOULD</em> support <code>signed_metadata</code> as specified in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8414" title="OAuth 2.0 Authorization Server Metadata">RFC8414</a></cite>] Section 2.1. In case signed metadata is available, this <em class="rfc2119">MUST</em> be used over non-signed metadata and the signature <em class="rfc2119">MUST</em> be verified prior to further utilizing any contents.</p>
<p>Clients <em class="rfc2119">MUST</em> use the public keys obtained from the <code>jwks</code> endpoint to validate the signature on tokens or to encrypt Request Objects to the OpenID Provider.</p>
</section><section id="registration"><div class="header-wrapper"><h3 id="x4-5-registration"><bdi class="secno">4.5 </bdi>Registration</h3><a class="self-link" href="#registration" aria-label="Permalink for Section 4.5"></a></div>
<p>All Clients <em class="rfc2119">MUST</em> register with the OpenID Provider.</p>
<p>Native Clients <em class="rfc2119">MUST</em> either be provisioned a unique per-instance Client identifier or be registered as <em>public</em> Clients by using a common Client identifier; browser-based Clients <em class="rfc2119">MUST</em> be registered as <em>public</em> Clients.</p>
<p>Clients <em class="rfc2119">SHOULD</em> use Dynamic Registration as per [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7591" title="OAuth 2.0 Dynamic Client Registration Protocol">RFC7591</a></cite>] to reduce manual labor and the risks of configuration errors. Dynamic Client Registration Management Protocol [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7592" title="OAuth 2.0 Dynamic Client Registration Management Protocol">RFC7592</a></cite>] <em class="rfc2119">MAY</em> be used by Clients.</p>
<p>In case a native Client is using per-instance registration, the Client <em class="rfc2119">MUST</em> use Dynamic Registration.</p>
</section></section><section id="openid-provider-profile"><div class="header-wrapper"><h2 id="x5-openid-provider-profile"><bdi class="secno">5. </bdi>OpenID Provider profile</h2><a class="self-link" href="#openid-provider-profile" aria-label="Permalink for Section 5."></a></div>
<p>For OpenID Providers the following items are applicable:</p>
<ul>
<li>OpenID Providers <em class="rfc2119">MUST</em> implement all <em>Mandatory to Implement Features for All OpenID Providers</em> (Section 15.1) and all <em>Mandatory to Implement Features for Dynamic OpenID Providers</em> (Section 15.2) of [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>]. Note that these Mandatory to Implement features include required support for the Hybrid Flow for authentication (Response Types <code>id_token</code> and <code>id_token token</code>). This profile deviates from this requirement, as this profile specifically forbids the use of the Hybrid Flow (see also <a href="#flow">Chapter 3</a>).</li>
<li>OpenID Providers <em class="rfc2119">MUST</em> support and require the use of 'Proof Key for Code Exchange' ([<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7636" title="Proof Key for Code Exchange by OAuth Public Clients">RFC7636</a></cite>]) using only the <code>S256</code> verification method and a code verifier with at least 43 and at most 128 cryptographically random characters to allow Clients to protect calls to the Token Endpoint.</li>
<li>OpenID Providers <em class="rfc2119">MUST</em> apply the necessary 'Cross-Origin Resource Sharing' ([<cite><a class="bibref" data-link-type="biblio" href="#bib-cors" title="Cross-Origin Resource Sharing">CORS</a></cite>]) headers to allow browsers to protect requests to its endpoints and <em class="rfc2119">SHOULD NOT</em> use wildcard origins.</li>
<li>OpenID Providers that support Web Applications <em class="rfc2119">SHOULD</em> follow the best practices specified in [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.browser-based-apps" title="OAuth 2.0 for Browser-Based Apps">OAuth2.Browser-Based-Apps</a></cite>].</li>
<li>OpenID Providers that support Native Applications <em class="rfc2119">MUST</em> follow the best practices specified in OAuth 2.0 for Native Apps [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8252" title="OAuth 2.0 for Native Apps">RFC8252</a></cite>].</li>
</ul>
<section id="authorization-endpoint-of-the-provider-profile"><div class="header-wrapper"><h3 id="x5-1-authorization-endpoint-of-the-provider-profile"><bdi class="secno">5.1 </bdi>Authorization Endpoint of the Provider profile</h3><a class="self-link" href="#authorization-endpoint-of-the-provider-profile" aria-label="Permalink for Section 5.1"></a></div>
<section id="request-objects-of-the-provider-profile"><div class="header-wrapper"><h4 id="x5-1-1-request-objects-of-the-provider-profile"><bdi class="secno">5.1.1 </bdi>Request Objects of the Provider profile</h4><a class="self-link" href="#request-objects-of-the-provider-profile" aria-label="Permalink for Section 5.1.1"></a></div>
<p>OpenID Providers <em class="rfc2119">MUST</em> accept requests containing a Request Object signed by the Client's private key. OpenID Providers <em class="rfc2119">MUST</em> validate the signature on such requests against the Client's registered public key. OpenID Providers <em class="rfc2119">MUST</em> accept Request Objects encrypted to the OpenID Provider's public key.</p>
<p>OpenID Providers <em class="rfc2119">SHOULD</em> accept Request Objects by reference using the <code>request_uri</code> parameter. The Request Object can be either hosted by the Client or pushed to the OpenID Provider prior to the Authentication Request. OpenID Providers <em class="rfc2119">MUST</em> verify that the <code>request_uri</code> parameter exactly matches one of the <code>request_uri</code> values for the Client pre-registered at the OpenID Provider, with the matching performed as described in Section 6.2.1 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3986" title="Uniform Resource Identifier (URI): Generic Syntax">RFC3986</a></cite>] (Simple String Comparison).</p>
<p>Using Request Objects allows for Clients to create a request that is protected from tampering through the browser, allowing for a higher security and privacy mode of operation for Clients and applications that require it. Clients are not required to use Request Objects, but OpenID Providers are required to support requests using them.</p>
<blockquote>
<p>Note that when a Request Object is used (either passed by value or by reference), the Client <em class="rfc2119">MAY</em> send the parameters included in the Request Object duplicated in the query parameters as well for backwards compatibility (so that the request is a valid OAuth 2.0 Authorization Request). However, the OpenID Provider <em class="rfc2119">MUST</em> only consider the parameters included in the Request Object and ignore the duplicated query parameters.</p>
</blockquote>
</section></section><section id="token-endpoint-of-the-provider-profile"><div class="header-wrapper"><h3 id="x5-2-token-endpoint-of-the-provider-profile"><bdi class="secno">5.2 </bdi>Token Endpoint of the Provider profile</h3><a class="self-link" href="#token-endpoint-of-the-provider-profile" aria-label="Permalink for Section 5.2"></a></div>
<section id="token-request-validation"><div class="header-wrapper"><h4 id="x5-2-1-token-request-validation"><bdi class="secno">5.2.1 </bdi>Token Request Validation</h4><a class="self-link" href="#token-request-validation" aria-label="Permalink for Section 5.2.1"></a></div>
<p>OpenID Providers <em class="rfc2119">MUST</em> validate all incoming Token Requests according to [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>], Section 3.1.3.2.</p>
<p>In addition, OpenID Providers <em class="rfc2119">MUST</em> validate the <code>code_verifier</code> value against the <code>code_challenge</code> and <code>code_challenge_method</code> values specified by the Client in the Authorization Request according to [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7636" title="Proof Key for Code Exchange by OAuth Public Clients">RFC7636</a></cite>], Section 4.6.</p>
</section><section id="id-tokens-of-the-provider-profile"><div class="header-wrapper"><h4 id="x5-2-2-id-tokens-of-the-provider-profile"><bdi class="secno">5.2.2 </bdi>ID Tokens of the Provider profile</h4><a class="self-link" href="#id-tokens-of-the-provider-profile" aria-label="Permalink for Section 5.2.2"></a></div>
<p>All ID Tokens <em class="rfc2119">MUST</em> be signed by the OpenID Provider's private signature key.
ID Tokens <em class="rfc2119">MAY</em> be encrypted using the appropriate key of the requesting Client.</p>
<p>The ID Token <em class="rfc2119">MUST</em> expire and <em class="rfc2119">SHOULD</em> have an active lifetime no longer than five minutes. Since the ID Token is consumed by the Client and not presented to remote systems, it is <em class="rfc2119">RECOMMENDED</em> that expiration times are kept as short as possible.</p>
<p>The Token Response includes an Access Token (which can be used to make a UserInfo request) and ID Token (a signed and optionally encrypted <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> Web Token). This profile imposes the following requirements on the Claims used in ID Tokens:</p>
<p><code>iss</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. The <code>issuer</code> field is the Uniform Resource Locator (URL) of the expected Issuer. Identical as in [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.igov" title="International Government Assurance Profile (iGov) for OpenID Connect 1.0">OpenID.iGov</a></cite>].</li>
</ul>
<p><code>aud</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. The <code>audience</code> field contains the Client ID of the Client. Identical as in [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.igov" title="International Government Assurance Profile (iGov) for OpenID Connect 1.0">OpenID.iGov</a></cite>].</li>
</ul>
<p><code>sub</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. The identifier of the authenticated End-User, also known as the subject. OpenID Providers <em class="rfc2119">MUST</em> support a pairwise identifier in accordance with the OpenID Connect specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>], section 8.1. See <a href="#pairwise-identifiers">Pairwise Identifiers</a> on when it may be useful to relax this requirement. Identical as in [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.igov" title="International Government Assurance Profile (iGov) for OpenID Connect 1.0">OpenID.iGov</a></cite>].</li>
</ul>
<p><code>sub_id_type</code></p>
<ul>
<li><em class="rfc2119">OPTIONAL</em>. The type of identifier passed in the <code>sub</code> Claim. In order to support multiple types of identifiers in an interoperable way, the type of identifier used for the identifier in the <code>sub</code> Claim <em class="rfc2119">SHOULD</em> be explicitly included. The value of the <code>sub_id_type</code> <em class="rfc2119">MUST</em> be a <abbr title="Uniform Resource Identifier">URI</abbr>. Values supported by the OpenID Provider are provided via the <a href="#discovery-endpoint">Discovery endpoint</a>.</li>
</ul>
<p><code>acr</code></p>
<ul>
<li><em class="rfc2119">OPTIONAL</em>. The <abbr title="Level of Assurance">LoA</abbr> the End-User was authenticated at. <em class="rfc2119">MUST</em> be at least the requested Level of Assurance value requested by the Client (either via the <code>acr_values</code> or <code>claims</code> parameters) or - if none was requested - a Level of Assurance established through prior agreement. See also <a href="#authentication-context">Section 5.2.3</a>. As <abbr title="Electronic Identification, Authentication and Trust Services">eIDAS</abbr> is leading in most scenarios targeted by this profile, using the <code>acr</code> Claim to express the Level of Assurance is preferred over Vectors of Trust (<code>vot</code>).</li>
</ul>
<p><code>nonce</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. <em class="rfc2119">MUST</em> contain the <code>nonce</code> value that was provided in the Authentication Request. Identical as in [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.igov" title="International Government Assurance Profile (iGov) for OpenID Connect 1.0">OpenID.iGov</a></cite>].</li>
</ul>
<p><code>jti</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. A unique identifier for the token, which can be used to prevent reuse of the token. The value of <code>jti</code> <em class="rfc2119">MUST</em> uniquely identify the ID Token between sender and receiver for at least 12 months.</li>
</ul>
<p><code>auth_time</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em> if <code>max_age</code> was specified in the request or when <code>auth_time</code> was requested as an Essential Claim. Otherwise <code>auth_time</code> is <em class="rfc2119">OPTIONAL</em> and <em class="rfc2119">SHOULD</em> be included if the OpenID Provider can assert an End-User's authentication intent was demonstrated. For example, a login event where the End-User took some action to authenticate. See also Section 15.1 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>].</li>
</ul>
<p><code>exp</code>, <code>iat</code>, <code>nbf</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. The <code>expiration</code>, <code>issued at</code>, and <code>not before</code> timestamps indicate when the token expires, was issued and becomes valid, respectively. The expiration time for ID Tokens is specific to the OpenID Provider. In line with [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.igov" title="International Government Assurance Profile (iGov) for OpenID Connect 1.0">OpenID.iGov</a></cite>].</li>
</ul>
<p><code>represents</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em> in case Representation is applicable, the <code>represents</code> Claim provides information about the effective authorization due to a Representation Relationship for the End-User.</li>
</ul>
<p><code>alt_sub</code></p>
<ul>
<li><em class="rfc2119">OPTIONAL</em>. Describes alternative Subject Identifiers for the authenticated End-User in the context of a specific audience. The value of <code>alt_sub</code> is an array of objects, each of which <em class="rfc2119">MUST</em> contain <code>sub</code> and <code>aud</code> Claims to uniquely identify the authenticated End-User and the audience for the alternative Subject Identifier and <em class="rfc2119">SHOULD</em> contain a <code>sub_id_type</code> Claim to explicitly indicate the type of identifier used in the <code>sub</code> claim if the OpenID Provider supports multiple types of subject identifiers.</li>
</ul>
<p><code>vot</code></p>
<ul>
<li><em class="rfc2119">OPTIONAL</em>. The vector value as specified in Vectors of Trust. <em class="rfc2119">MUST NOT</em> be included when <code>acr</code> is included. See also <a href="#vectors-of-trust">Section 5.2.4</a>.</li>
</ul>
<p><code>vtm</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em> if <code>vot</code> is provided. The trustmark <abbr title="Uniform Resource Identifier">URI</abbr> as specified in Vectors of Trust. See also <a href="#vectors-of-trust">Section 5.2.4</a>.</li>
</ul>
<p>Other Claims <em class="rfc2119">MAY</em> be included. See Claims Request below on how such Claims <em class="rfc2119">SHOULD</em> be requested by the Client to be provided by the OpenID Provider.</p>
<aside class="example" id="example-2"><div class="marker">
    <a class="self-link" href="#example-2">Example<bdi> 2</bdi></a>
  </div>
  
<p>This example ID Token has been signed using the server's RSA key:</p>
<pre aria-busy="false"><code class="hljs">eyJhbGciOiJSUzI1NiJ9.eyJleHAiOjE0MTg2OTk0
MTIsInN1YiI6IjZXWlFQcG5ReFYiLCJzdWJfaWRfd
HlwZSI6InVybjpubC1laWQtZ2RpOjEuMDppZDpwc2
V1ZG9ueW0iLCJub25jZSI6IjE4ODYzN2IzYWYxNGE
iLCJhdWQiOlsiYzFiYzg0ZTQtNDdlZS00YjY0LWJi
NTItNWNkYTZjODFmNzg4Il0sImFsdF9zdWIiOlt7I
mF1ZCI6IjM3OWIwMjJkLWQ5ZDAtNGM0My1iN2RlLT
I5MGEwMjNlYjQ2MSIsInN1YiI6InhTSENyRm05Qkc
iLCJzdWJfaWRfdHlwZSI6InVybjpubC1laWQtZ2Rp
OjEuMDppZDpwc2V1ZG9ueW0ifV0sImlzcyI6Imh0d
HBzOi8vaWRwLXAuZXhhbXBsZS5jb20vIiwiYWNyIj
oiaHR0cDovL2VpZGFzLmV1cm9wYS5ldS9Mb0Evc3V
ic3RhbnRpYWwiLCJpYXQiOjE0MTg2OTg4MTIsImp0
aSI6ImE2NWM1NjBkLTA4NWMtNDY2ZS05N2M1LWY4N
jM5ZmNhNWVhNyIsIm5iZiI6MTQxODY5OTExMn0</code></pre>
<p>Its Claims are as follows:</p>
<pre aria-busy="false"><code class="hljs json">{
       <span class="hljs-attr">"auth_time"</span>: <span class="hljs-number">1418698782</span>,
       <span class="hljs-attr">"exp"</span>: <span class="hljs-number">1418699412</span>,
       <span class="hljs-attr">"sub"</span>: <span class="hljs-string">"6WZQPpnQxV"</span>,
       <span class="hljs-attr">"sub_id_type"</span>: <span class="hljs-string">"urn:nl-eid-gdi:1.0:id:pseudonym"</span>,
       <span class="hljs-attr">"nonce"</span>: <span class="hljs-string">"188637b3af14a"</span>,
       <span class="hljs-attr">"aud"</span>: [
         <span class="hljs-string">"c1bc84e4-47ee-4b64-bb52-5cda6c81f788"</span>
       ],
       <span class="hljs-attr">"alt_sub"</span>: [{
         <span class="hljs-attr">"aud"</span>: <span class="hljs-string">"379b022d-d9d0-4c43-b7de-290a023eb461"</span>,
         <span class="hljs-attr">"sub"</span>: <span class="hljs-string">"xSHCrFm9BG"</span>,
         <span class="hljs-attr">"sub_id_type"</span>: <span class="hljs-string">"urn:nl-eid-gdi:1.0:id:pseudonym"</span>
       }],
       <span class="hljs-attr">"iss"</span>: <span class="hljs-string">"https://idp-p.example.com/"</span>,
       <span class="hljs-attr">"acr"</span>: <span class="hljs-string">"http://eidas.europa.eu/LoA/substantial"</span>,
       <span class="hljs-attr">"iat"</span>: <span class="hljs-number">1418698812</span>,
       <span class="hljs-attr">"jti"</span>: <span class="hljs-string">"a65c560d-085c-466e-97c5-f8639fca5ea7"</span>,
       <span class="hljs-attr">"nbf"</span>: <span class="hljs-number">1418699112</span>,
 }</code></pre>
</aside>

</section><section id="pairwise-identifiers"><div class="header-wrapper"><h4 id="x5-2-3-pairwise-identifiers"><bdi class="secno">5.2.3 </bdi>Pairwise Identifiers</h4><a class="self-link" href="#pairwise-identifiers" aria-label="Permalink for Section 5.2.3"></a></div>
<p>Pairwise Subject Identifiers specified in OpenID Connect Core [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>] Section 8 help protect an End-User's privacy by allowing an OpenID Provider to represent a single End-User with a different Subject Identifier (<code>sub</code>) for every Client the End-User connects to. This technique can help mitigate correlation of an End-User between multiple Clients and therewith tracking of End-Users between different sites and applications.</p>
<p>Use of pairwise identifiers does not prevent Clients from correlating data based on other identifying attributes such as names, phone numbers, email addresses, document numbers, or other attributes. However, since not all transactions require access to these attributes, but a Subject Identifier is always required, a pairwise identifier will aid in protecting the privacy of End-Users as they navigate the system.</p>
<p>OpenID Providers <em class="rfc2119">MUST</em> support pairwise identifiers for cases where correlation of End-User's activities across Clients is not appropriate. OpenID Providers <em class="rfc2119">MAY</em> support public identifiers for frameworks where public identifiers are required, or for cases where public identifiers are shared as attributes and the framework does not have a requirement for subject anonymity.</p>
<p><em>Burgerservicenummers (<abbr title="Burgerservicenummer, the identification number for citizen in The Netherlands">BSN</abbr>)</em>, <em>Rechtspersonen en Samenwerkingsverbanden Identificatienummers (<abbr title="Rechtspersonen en Samenwerkingsverbanden Identificatienummer, the identification number for legal entities and associations in The Netherlands">RSIN</abbr>)</em> and <em>Kamer van Koophandel (<abbr title="Kamer van Koophandel, the Dutch Chamber of Commerce">KvK</abbr>) nummers</em> are considered public sectoral identifiers and therefore <em class="rfc2119">MUST NOT</em> be used as Subject Identifiers in case correlation of End-User's activities across Clients is not appropriate. In such cases, the use of Polymorphic Pseudonyms or Polymorphic Identities is preferred.</p>
<blockquote>
<p>Note that BSNs <em class="rfc2119">MUST</em> only be used by Relying Parties for Services eligible for using the <abbr title="Burgerservicenummer, the identification number for citizen in The Netherlands">BSN</abbr> according to Dutch Law and that the <abbr title="Burgerservicenummer, the identification number for citizen in The Netherlands">BSN</abbr>, or token containing it, <em class="rfc2119">SHOULD</em> be encrypted.</p>
</blockquote>
</section><section id="representation-relationships"><div class="header-wrapper"><h4 id="x5-2-4-representation-relationships"><bdi class="secno">5.2.4 </bdi>Representation Relationships</h4><a class="self-link" href="#representation-relationships" aria-label="Permalink for Section 5.2.4"></a></div>
<p>In Use Cases that involve Representation Relationships, Representation Relationships are explicitly mentioned in the form of a <code>represents</code> Claim, analogous to the Delegation Semantics specified in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8693" title="OAuth 2.0 Token Exchange">RFC8693</a></cite>].</p>
<blockquote>
<p><strong>Note</strong>: Whereas [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8693" title="OAuth 2.0 Token Exchange">RFC8693</a></cite>] lists the End-User in the <code>act</code> or <code>may_act</code> Claims and the represented service consumer in the <code>sub</code> Claim, this is reversed in this profile: the End-User is listed in the <code>sub</code> Claim and the represented service consumer is listed in the <code>represents</code> Claim. Reason for this is to mitigate the risk that a Client that does not explicitly supports the Representation Use Cases cannot recognize the difference between an End-User that authenticates on behalf of himself or on behalf of someone else via Representation.</p>
</blockquote>
<p>As such, all Clients <em class="rfc2119">MUST</em> process <code>represents</code> Claims used, in case Representation can be applicable in the context of the OpenID Client and OpenID Provider. As an exception, <code>represents</code> Claims <em class="rfc2119">MAY</em> be ignored by the Client if, and only if, it is explicitly agreed upon beforehand that no Representation will be provided.</p>
<p>This profile specifies Representation Relations in ID Tokens as follows:</p>
<ul>
<li>The End-User is always identified by the <code>sub</code> Claim;</li>
<li>The represented service consumer is mentioned in the <code>represents</code> Claim.</li>
<li>In case a chain representation is applicable, the representation chain is represented as a series of nested <code>represents</code> Claims with the represented service consumer listed as the deepest nested <code>represents</code> Claim.</li>
<li>Each <code>represents</code> Claim <em class="rfc2119">MUST</em> contain <code>sub</code> and <code>iss</code> Claims to uniquely identify the represented party and <em class="rfc2119">SHOULD</em> contain a <code>sub_id_type</code> Claim to explicitly indicate the type of identifier used in the <code>sub</code> claim if the OpenID Provider supports multiple types of subject identifiers.</li>
<li><code>represents</code> Claims <em class="rfc2119">MAY</em> contain additional Claims (e.g. <code>email</code>) to provide additional useful information about the represented party.</li>
<li>Claims within the <code>represents</code> Claim pertain only to the identity of that party and <em class="rfc2119">MUST NOT</em> contain Claims that are not related to the represented party, such as top-level Claims <code>exp</code>, <code>nbf</code>, and <code>aud</code>.</li>
</ul>
<aside class="example" id="example-3"><div class="marker">
    <a class="self-link" href="#example-3">Example<bdi> 3</bdi></a>
  </div>
A sample chain representation for a requested scope <code>urn:uuid:a9e17a2e-d358-406d-9d5f-ad6045f712ba</code> may look like (note: the requested scope also includes the required <code>openid</code> scope; Claims that do not add to the example are omitted for readability):
<pre aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"scope"</span>: <span class="hljs-string">"openid urn:uuid:a9e17a2e-d358-406d-9d5f-ad6045f712ba"</span>,
  <span class="hljs-comment">/* End-User - representing the service consumer */</span>
  <span class="hljs-attr">"sub"</span>: <span class="hljs-string">"RKyLpEVr1L"</span>,
  <span class="hljs-attr">"sub_id_type"</span>: <span class="hljs-string">"urn:nl-eid-gdi:1.0:id:pseudonym"</span>,
  <span class="hljs-attr">"iss"</span>: <span class="hljs-string">"urn:uuid:b556992a-e233-4fdc-915a-e2b52d3cc355"</span>,
  <span class="hljs-attr">"represents"</span>: {
    <span class="hljs-comment">/* Intermediary in representation chain - an organization in this example */</span>
    <span class="hljs-attr">"sub"</span>: <span class="hljs-string">"492099595"</span>,
    <span class="hljs-attr">"sub_id_type"</span>: <span class="hljs-string">"urn:nl-eid-gdi:1.0:id:RSIN"</span>,
    <span class="hljs-attr">"iss"</span>: <span class="hljs-string">"urn:uuid:28e0686f-20ff-41bd-8520-57b9c68cc9a3"</span>,
    <span class="hljs-attr">"alt_sub"</span>: {
      <span class="hljs-attr">"sub"</span>: <span class="hljs-string">"27381312"</span>,
      <span class="hljs-attr">"sub_id_type"</span>: <span class="hljs-string">"urn:nl-eid-gdi:1.0:id:KvKnr"</span>,
      <span class="hljs-attr">"iss"</span>: <span class="hljs-string">"urn:uuid:ebc29845-d35f-4c6a-bbb2-a59fdcb1cc6b"</span>
    }
    <span class="hljs-string">"represents"</span>: {
      <span class="hljs-comment">/* service consumer - represented by the End-User */</span>
      <span class="hljs-attr">"sub"</span>: <span class="hljs-string">"4Yg8u72NxR"</span>,
      <span class="hljs-attr">"sub_id_type"</span>: <span class="hljs-string">"urn:nl-eid-gdi:1.0:id:pseudonym"</span>,
      <span class="hljs-attr">"iss"</span>: <span class="hljs-string">"urn:uuid:55291cc0-fd2a-4eb6-b444-5b2783e62673"</span>
    }
  }
}</code></pre>
</aside>

</section><section id="authentication-context"><div class="header-wrapper"><h4 id="x5-2-5-authentication-context"><bdi class="secno">5.2.5 </bdi>Authentication Context</h4><a class="self-link" href="#authentication-context" aria-label="Permalink for Section 5.2.5"></a></div>
<p>Whereas the iGov Assurance Profile for OpenID Connect [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.igov" title="International Government Assurance Profile (iGov) for OpenID Connect 1.0">OpenID.iGov</a></cite>] recommends the use of Vectors of Trust (<code>vot</code>) to determine the amount of trust to be placed in digital transactions, using Authentication Context Class References (<code>acr</code>) instead is <em class="rfc2119">RECOMMENDED</em> by this profile, due to their better alignment to the Levels of Assurance (<abbr title="Level of Assurance">LoA</abbr>) defined by the <code><abbr title="Electronic Identification, Authentication and Trust Services">eIDAS</abbr></code> standards that are used in the European Union.</p>
<p>OpenID Providers <em class="rfc2119">SHOULD</em> use <abbr title="Electronic Identification, Authentication and Trust Services">eIDAS</abbr> Level of Assurance (<abbr title="Level of Assurance">LoA</abbr>) values for the <code>acr</code> Claim, but <em class="rfc2119">MAY</em> use different values if <abbr title="Electronic Identification, Authentication and Trust Services">eIDAS</abbr> is not applicable. The <abbr title="Electronic Identification, Authentication and Trust Services">eIDAS</abbr> Level of Assurance values are defined as URIs in [<cite><a class="bibref" data-link-type="biblio" href="#bib-eidas.saml" title="eIDAS SAML Message Format">eIDAS.SAML</a></cite>], Section 3.2.</p>
<p>OpenID Providers <em class="rfc2119">MUST</em> provide a Level of Assurance as <code>acr</code> value that is at least the requested Level of Assurance value requested by the Client (either via the <code>acr_values</code> or <code>claims</code> parameters) or - if none was requested - a Level of Assurance established through prior agreement.</p>
<p>OpenID Providers <em class="rfc2119">MUST NOT</em> provide Authentication Methods References (<code>amr</code>), but <em class="rfc2119">MUST</em> use Authentication Context Class References (<code>acr</code>) instead.</p>
<p>Clients <em class="rfc2119">MAY</em> send an <code>vtr</code> (Vectors of Trust Request) parameter. If both the <code>vtr</code> and <code>acr_values</code> are in the request, the <code>acr_values</code> <em class="rfc2119">MUST</em> take precedence and the <code>vtr</code> <em class="rfc2119">MUST</em> be ignored.</p>
<blockquote>
<p><strong>Note:</strong> Risk Based Authentication (<abbr title="Risk Based Authentication">RBA</abbr>) should be an integral part of the <abbr title="Level of Assurance">LoA</abbr> framework that is used by an OpenID Provider (the Identity Provider), such that the risk criteria for the resulting authentication are at least sufficient to meet the applicable <abbr title="Level of Assurance">LoA</abbr>. That is, an OpenID Provider <em class="rfc2119">MAY</em> apply <abbr title="Risk Based Authentication">RBA</abbr> to require authentication methods with enhanced security or ease towards more user friendly methods when allowed by evaluated risk for an authentication, as long as the trust framework requirements are met. Selection of and criteria for any <abbr title="Level of Assurance">LoA</abbr> framework are, however, situation specific and beyond the scope of this profile.</p>
</blockquote>
</section><section id="vectors-of-trust"><div class="header-wrapper"><h4 id="x5-2-6-vectors-of-trust"><bdi class="secno">5.2.6 </bdi>Vectors of Trust</h4><a class="self-link" href="#vectors-of-trust" aria-label="Permalink for Section 5.2.6"></a></div>
<p>OpenID Providers <em class="rfc2119">MAY</em> provide <code>vot</code> (Vectors of Trust) and <code>vtm</code> (Vector Trust Mark) values in ID Tokens only if the <code>acr</code> Claim is not requested by the Client (either via the <code>acr_values</code> or <code>claims</code> parameters). More information on Vectors of Trust is provided in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8485" title="Vectors of Trust">RFC8485</a></cite>].</p>
</section><section id="access-tokens"><div class="header-wrapper"><h4 id="x5-2-7-access-tokens"><bdi class="secno">5.2.7 </bdi>Access Tokens</h4><a class="self-link" href="#access-tokens" aria-label="Permalink for Section 5.2.7"></a></div>
<p>This profile requires an Access Token to be in <abbr title="JSON Web Token">JWT</abbr> form. This is in line with the underlying NL GOV Assurance profile for OAuth 2.0 [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.nlgov" title="NL GOV Assurance profile for OAuth 2.0">OAuth2.NLGov</a></cite>].</p>
<p>Using a <abbr title="JSON Web Token">JWT</abbr> formatted Access Token allows any OpenID Client to consume and verify a token without the need for introspection, thus reducing the dependency on an interaction with an external endpoint. As a result this may reduce load and availability requirements on the OpenID Provider. Furthermore, it provides a more uniform format over Access Token, ID Token, UserInfo response and Introspection response.</p>
<blockquote>
<p>Note that ID Tokens and UserInfo responses are primarily intended for the Client. The Access Token is primarily intended for consumption by a Resource Server. The Introspection response is intended for the requestor of an Introspection, which can be either a Client or Resource Server.
The Resource Server is typically not considered as an actor in OpenID Connect, but OpenID Providers will often act as Authorization Servers. In the case of Service Intermediation this is applicable by definition.
This profile does not directly place any constraints on the placement of Claims in various tokens or response messages. Claims may be placed in any of the four tokens/response messages, unless explicitly specified otherwise. This allows for maximum flexibility and interoperability.</p>
</blockquote>
</section><section id="refresh-tokens"><div class="header-wrapper"><h4 id="x5-2-8-refresh-tokens"><bdi class="secno">5.2.8 </bdi>Refresh Tokens</h4><a class="self-link" href="#refresh-tokens" aria-label="Permalink for Section 5.2.8"></a></div>
<p>OpenID Providers <em class="rfc2119">MAY</em> issue Refresh Tokens to Clients; when used, Refresh Tokens <em class="rfc2119">MUST</em> be one-time-use or sender-constrained.</p>
<p>OpenID Providers <em class="rfc2119">MAY</em> cryptographically bind Refresh Tokens to the specific Client instance (see also [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.1" title="OAuth 2.1 Working draft">OAuth2.1</a></cite>], Section 6.1); other methods to create sender-constrained Refresh Tokens <em class="rfc2119">MAY</em> be applied as well.</p>
<p>For security reasons, Refresh Tokens that are not sender-constrained <em class="rfc2119">MUST</em> be one-time-use, i.e. with every Access Token refresh response the OpenID Provider can issue a new Refresh Token and <em class="rfc2119">MUST</em> invalidate the previous Refresh Token (see also [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6819" title="OAuth 2.0 Threat Model and Security Considerations">RFC6819</a></cite>], Section 5.2.2.3 and [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.1" title="OAuth 2.1 Working draft">OAuth2.1</a></cite>], Section 6.1).</p>
<p>Refresh Tokens <em class="rfc2119">MUST</em> expire if the Client has been inactive for some time, i.e., the Refresh Token has not been used to obtain fresh Access Tokens for some time. The expiration time is at the discretion of the OpenID Provider, but <em class="rfc2119">MUST NOT</em> exceed a maximum of 6 hours, preferably shorter.</p>
<p>For public Clients, no cryptographic key or Client Authentication method for binding Refresh Tokens to a specific Client is available. Public Clients therefore <em class="rfc2119">MUST</em> use one-time-use Refresh Tokens with a limited validity, if applied.</p>
</section></section><section id="userinfo-endpoint"><div class="header-wrapper"><h3 id="x5-3-userinfo-endpoint"><bdi class="secno">5.3 </bdi>UserInfo Endpoint</h3><a class="self-link" href="#userinfo-endpoint" aria-label="Permalink for Section 5.3"></a></div>
<p>OpenID Providers <em class="rfc2119">MUST</em> support the UserInfo Endpoint and, at a minimum, the <code>sub</code> (subject) Claim. It is expected that the <code>sub</code> Claim will remain pseudonymous in Use Cases where obtaining personal information is not needed.</p>
<p>Support for a UserInfo Endpoint is important for maximum Client implementation interoperability even if no additional End-User information is returned. Clients are not required to call the UserInfo Endpoint, but <em class="rfc2119">SHOULD NOT</em> receive an error if they do.</p>
<aside class="example" id="example-4"><div class="marker">
    <a class="self-link" href="#example-4">Example<bdi> 4</bdi></a>
  </div>
In an example transaction, the Client sends a request to the UserInfo Endpoint like the following:
<pre aria-busy="false"><code class="hljs">GET /userinfo HTTP/1.1
Authorization: Bearer eyJhbGciOiJSUzI1NiJ9.eyJleHAiOjE0MTg3MDI0MTIsIm
  F1ZCI6WyJjMWJjODRlNC00N2VlLTRiNjQtYmI1Mi01Y2RhNmM4MWY3ODgiXSwiaXNzIjo
  iaHR0cHM6XC9cL2lkcC1wLmV4YW1wbGUuY29tXC8iLCJqdGkiOiJkM2Y3YjQ4Zi1iYzgx
  LTQwZWMtYTE0MC05NzRhZjc0YzRkZTMiLCJpYXQiOjE0MTg2OTg4MTJ9i.HMz_tzZ90_b
  0QZS-AXtQtvclZ7M4uDAs1WxCFxpgBfBanolW37X8h1ECrUJexbXMD6rrj_uuWEqPD738
  oWRo0rOnoKJAgbF1GhXPAYnN5pZRygWSD1a6RcmN85SxUig0H0e7drmdmRkPQgbl2wMhu
  -6h2Oqw-ize4dKmykN9UX_2drXrooSxpRZqFVYX8PkCvCCBuFy2O-HPRov_SwtJMk5qjU
  WMyn2I4Nu2s-R20aCA-7T5dunr0iWCkLQnVnaXMfA22RlRiU87nl21zappYb1_EHF9ePy
  q3Q353cDUY7vje8m2kKXYTgc_bUAYuW-W3SMSw5UlKaHtSZ6PQICoA
Accept: application/json
Host: idp-p.example.com
Connection: Keep-Alive</code></pre>
And receives a document in response like the following:
<pre aria-busy="false"><code class="hljs http"><span class="hljs-meta">HTTP/1.1</span> <span class="hljs-number">200</span> OK
<span class="hljs-attribute">Date</span><span class="hljs-punctuation">: </span>Mon, 16 Dec 2019 03:00:12 GMT
<span class="hljs-attribute">Access-Control-Allow-Origin</span><span class="hljs-punctuation">: </span>*
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json
<span class="hljs-attribute">Content-Language</span><span class="hljs-punctuation">: </span>en-US
<span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>333
<span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close</code></pre>
<pre aria-busy="false"><code class="hljs json">{
   <span class="hljs-attr">"sub"</span>: <span class="hljs-string">"6WZQPpnQxV"</span>,
   <span class="hljs-attr">"iss"</span>: <span class="hljs-string">"https://idp-p.example.com"</span>,
   <span class="hljs-attr">"given_name"</span>: <span class="hljs-string">"Stephen"</span>,
   <span class="hljs-attr">"family_name"</span>: <span class="hljs-string">"Emeritus"</span>,
}</code></pre>
</aside>

<p>OpenID Providers <em class="rfc2119">MUST</em> support the generation of <abbr title="JSON Web Token">JWT</abbr> encoded responses from the UserInfo Endpoint. Responding with unsigned <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> objects when neither signing nor encryption are requested by the Client as part of the <code>userinfo_signed_response_alg</code> and <code>userinfo_encrypted_response_alg</code> Client metadata parameters registered as part of Client Registration is <em class="rfc2119">OPTIONAL</em>. Signed responses <em class="rfc2119">MUST</em> be signed by the OpenID Provider's signing key, and encrypted responses <em class="rfc2119">MUST</em> be encrypted with the authorized Client's public key. Please refer to <a href="#algorithms">Algorithms</a> for more information on cryptographic algorithms and keys.</p>
</section><section id="discovery-0"><div class="header-wrapper"><h3 id="x5-4-discovery"><bdi class="secno">5.4 </bdi>Discovery</h3><a class="self-link" href="#discovery-0" aria-label="Permalink for Section 5.4"></a></div>
<p>The OpenID Connect Discovery [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.discovery" title="OpenID Connect Discovery 1.0">OpenID.Discovery</a></cite>] standard provides a standard, programmatic way for Clients to obtain configuration details for communicating with OpenID Providers. Discovery is an important part of building scalable federation ecosystems.</p>
<p>OpenID Providers under this profile <em class="rfc2119">MUST</em> publish their server metadata to help minimize configuration errors and support automation for scalable deployments.</p>
<ul>
<li>Exposing a Discovery endpoint does NOT inherently put the OpenID Provider at risk to attack. Endpoints and parameters specified in the Discovery document <em class="rfc2119">SHOULD</em> be considered public information regardless of the existence of the Discovery document.</li>
<li>Access to the Discovery document <em class="rfc2119">MAY</em> be protected with existing web authentication methods if required by the OpenID Provider. Credentials for the Discovery document are then managed by the OpenID Provider. Support for these authentication methods is outside the scope of this profile.</li>
<li>Endpoints described in the Discovery document <em class="rfc2119">MUST</em> be secured in accordance with this profile and <em class="rfc2119">MAY</em> have additional controls the Provider wishes to support.</li>
</ul>
<section id="discovery-endpoint"><div class="header-wrapper"><h4 id="x5-4-1-discovery-endpoint"><bdi class="secno">5.4.1 </bdi>Discovery endpoint</h4><a class="self-link" href="#discovery-endpoint" aria-label="Permalink for Section 5.4.1"></a></div>
<p>All OpenID Providers are uniquely identified by a URL known as the <code>issuer</code> and <em class="rfc2119">MUST</em> make a Discovery document in <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> format available at the path formed by concatenating <code>/.well-known/openid-configuration</code> to the <code>issuer</code> and <em class="rfc2119">SHOULD</em> also make this Discovery document available at the path formed by concatenating <code>/.well-known/oauth-authorization-server</code> to the <code>issuer</code>. OpenID Providers <em class="rfc2119">MAY</em> also publish their Discovery documents on other locations. All paths on which the Discovery document is published <em class="rfc2119">MUST</em> use the <code>https</code> scheme.</p>
<blockquote>
<p>Note that for privacy considerations, only direct requests to the server metadata document <em class="rfc2119">SHOULD</em> be used. The WebFinger method to locate the relevant OpenID Provider and its metadata, as described in [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.discovery" title="OpenID Connect Discovery 1.0">OpenID.Discovery</a></cite>] section 2, <em class="rfc2119">MUST NOT</em> be supported.</p>
</blockquote>
</section><section id="discovery-document"><div class="header-wrapper"><h4 id="x5-4-2-discovery-document"><bdi class="secno">5.4.2 </bdi>Discovery document</h4><a class="self-link" href="#discovery-document" aria-label="Permalink for Section 5.4.2"></a></div>
<p>This profile imposes the following requirements upon the Discovery document:</p>
<p><code>issuer</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. The fully qualified Issuer URL of the OpenID Provider as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8414" title="OAuth 2.0 Authorization Server Metadata">RFC8414</a></cite>].</li>
</ul>
<p><code>authorization_endpoint</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. The fully qualified URL of the OpenID Provider's Authorization Endpoint as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6749" title="The OAuth 2.0 Authorization Framework">RFC6749</a></cite>].</li>
</ul>
<p><code>token_endpoint</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. The fully qualified URL of the OpenID Provider's Token Endpoint as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6749" title="The OAuth 2.0 Authorization Framework">RFC6749</a></cite>].</li>
</ul>
<p><code>userinfo_endpoint</code></p>
<ul>
<li><em class="rfc2119">RECOMMENDED</em>. The fully qualified URL of the OpenID Provider's Userinfo Endpoint as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>].</li>
</ul>
<p><code>registration_endpoint</code></p>
<ul>
<li><em class="rfc2119">RECOMMENDED</em>. The fully qualified URL of the OpenID Provider's Dynamic Registration endpoint [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7591" title="OAuth 2.0 Dynamic Client Registration Protocol">RFC7591</a></cite>].</li>
</ul>
<p><code>introspection_endpoint</code></p>
<ul>
<li><em class="rfc2119">OPTIONAL</em>. The fully qualified URL of the OpenID Provider's Introspection Endpoint as defined by 'OAuth 2.0 Token Introspection' [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7662" title="OAuth 2.0 Token Introspection">RFC7662</a></cite>].</li>
</ul>
<p><code>revocation_endpoint</code></p>
<ul>
<li><em class="rfc2119">OPTIONAL</em>. The fully qualified URL of the OpenID Provider's Revocation Endpoint as defined by 'OAuth 2.0 Token Revocation' [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7009" title="OAuth 2.0 Token Revocation">RFC7009</a></cite>].</li>
</ul>
<p><code>jwks_uri</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. The fully qualified URL of the OpenID Provider's public keys in JWK Set format. These keys can be used by Clients to verify signatures on tokens and responses from the OpenID Provider and for encrypting requests to the OpenID Provider.</li>
</ul>
<p><code>scopes_supported</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. The list of scopes the OpenID Provider supports as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8414" title="OAuth 2.0 Authorization Server Metadata">RFC8414</a></cite>].</li>
</ul>
<p><code>response_types_supported</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> array containing the list of OAuth 2.0 <code>response_type</code> values that the OpenID Provider supports. In the context of this profile, the value <em class="rfc2119">MUST</em> Be ['code'].</li>
</ul>
<p><code>grant_types_supported</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> array containing the list of OAuth 2.0 <code>grant_type</code> values that the OpenID Provider supports. In the context of this profile, the value <em class="rfc2119">MUST</em> be ['authorization_code'].</li>
</ul>
<p><code>claims_parameter_supported</code></p>
<ul>
<li><em class="rfc2119">OPTIONAL</em>. Boolean value specifying whether the OpenID Provider supports the use of the <code>claims</code> parameter, as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.discovery" title="OpenID Connect Discovery 1.0">OpenID.Discovery</a></cite>].</li>
</ul>
<p><code>claims_supported</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> array containing the list of Claims available in the supported scopes as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.discovery" title="OpenID Connect Discovery 1.0">OpenID.Discovery</a></cite>]. See <a href="#claims-supported">Claims Supported</a>.</li>
</ul>
<p><code>claim_types_supported</code></p>
<ul>
<li><em class="rfc2119">OPTIONAL</em>. <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> array containing the list of Claim types that the OpenID Provider supports. <em class="rfc2119">REQUIRED</em> when <code>aggregated</code> or <code>distributed</code> Claims are used. If omitted, the OpenID Provider only supports <code>normal</code> Claims. Identical to [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.discovery" title="OpenID Connect Discovery 1.0">OpenID.Discovery</a></cite>].</li>
</ul>
<p><code>sub_id_types_supported</code></p>
<ul>
<li><em class="rfc2119">OPTIONAL</em>. <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> array containing the list of supported types of Subject Identifiers in the <code>sub</code> Claim of ID Tokens. The values <em class="rfc2119">MUST</em> be URIs, the exact URIs to be used are situation specific; as an example encrypted BSNs and Pseudonyms could be specified with <code>urn:nl-eid-gdi:1.0:id:<abbr title="Burgerservicenummer, the identification number for citizen in The Netherlands">BSN</abbr></code> or <code>urn:nl-eid-gdi:1.0:id:Pseudonym</code> respectively.</li>
</ul>
<p><code>acr_values_supported</code></p>
<ul>
<li><em class="rfc2119">OPTIONAL</em>. <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> array containing the list of supported Levels of Assurances, as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.discovery" title="OpenID Connect Discovery 1.0">OpenID.Discovery</a></cite>]. See <a href="#authentication-context">Authentication Context</a>.</li>
</ul>
<p><code>subject_types_supported</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> array containing the list of Subject Identifier types that this OpenID Provider supports. Valid types include <code>pairwise</code> and <code>public</code>.</li>
</ul>
<p><code>token_endpoint_auth_methods_supported</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> array containing the list of Client Authentication methods that this OpenID Provider supports. With respect to this profile, the allowed values are <code>private_key_jwt</code>, <code>tls_client_auth</code>, or both.</li>
</ul>
<p><code>id_token_signing_alg_values_supported</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> array containing the list of <abbr title="JSON Web Signature">JWS</abbr> signing algorithms (<code>alg</code> values) supported by the OpenID Provider for the ID Token to encode the Claims in a <abbr title="JSON Web Token">JWT</abbr>. For more information, refer to <a href="#algorithms">Algorithms</a>.</li>
</ul>
<p><code>id_token_encryption_alg_values_supported</code></p>
<ul>
<li><em class="rfc2119">OPTIONAL</em>. <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> array containing the list of <abbr title="JSON Web Encryption">JWE</abbr> encryption algorithms (<code>alg</code> values) supported by the OpenID Provider for the ID Token to encrypt the Content Encryption Key (<abbr title="Content Encryption Key">CEK</abbr>). <em class="rfc2119">REQUIRED</em> when the OpenID Provider supports encryption of ID Tokens. For more information, refer to <a href="#algorithms">Algorithms</a>.</li>
</ul>
<p><code>id_token_encryption_enc_values_supported</code></p>
<ul>
<li><em class="rfc2119">OPTIONAL</em>. <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> array containing the list of <abbr title="JSON Web Encryption">JWE</abbr> encryption algorithms (<code>enc</code> values) supported by the OpenID Provider for the ID Token to encrypt the Claims in a <abbr title="JSON Web Token">JWT</abbr> using the <abbr title="Content Encryption Key">CEK</abbr>. <em class="rfc2119">REQUIRED</em> when the OpenID Provider supports encryption of ID Tokens. For more information, refer to <a href="#algorithms">Algorithms</a>.</li>
</ul>
<p><code>userinfo_signing_alg_values_supported</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> array containing the list of <abbr title="JSON Web Signature">JWS</abbr> signing algorithms (<code>alg</code> values) supported by the UserInfo Endpoint to encode the Claims in a <abbr title="JSON Web Token">JWT</abbr>. For more information, refer to <a href="#algorithms">Algorithms</a>.</li>
</ul>
<p><code>userinfo_encryption_alg_values_supported</code></p>
<ul>
<li><em class="rfc2119">OPTIONAL</em>. <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> array containing the list of <abbr title="JSON Web Encryption">JWE</abbr> encryption algorithms (<code>alg</code> values) supported by the OpenID Provider for the UserInfo Endpoint to encrypt the Content Encryption Key (<abbr title="Content Encryption Key">CEK</abbr>). <em class="rfc2119">REQUIRED</em> when the OpenID Provider supports encryption of UserInfo responses. For more information, refer to <a href="#algorithms">Algorithms</a>.</li>
</ul>
<p><code>userinfo_encryption_enc_values_supported</code></p>
<ul>
<li><em class="rfc2119">OPTIONAL</em>. <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> array containing the list of <abbr title="JSON Web Encryption">JWE</abbr> encryption algorithms (<code>enc</code> values) supported by the OpenID Provider for the UserInfo Endpoint to encrypt the Claims in a <abbr title="JSON Web Token">JWT</abbr> using the <abbr title="Content Encryption Key">CEK</abbr>. <em class="rfc2119">REQUIRED</em> when the OpenID Provider supports encryption of UserInfo responses. For more information, refer to <a href="#algorithms">Algorithms</a>.</li>
</ul>
<p><code>request_object_signing_alg_values_supported</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em>. <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> array containing the list of <abbr title="JSON Web Signature">JWS</abbr> signing algorithms (<code>alg</code> values) supported by the OpenID Provider for Request Objects. These algorithms are applicable for Request Objects passed by value and passed by reference. For more information, refer to <a href="#algorithms">Algorithms</a>.</li>
</ul>
<p><code>request_object_encryption_alg_values_supported</code></p>
<ul>
<li><em class="rfc2119">OPTIONAL</em>. <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> array containing the list of <abbr title="JSON Web Encryption">JWE</abbr> encryption algorithms (<code>alg</code> values) supported by the OpenID Provider for Request Objects to encrypt the Content Encryption Key (<abbr title="Content Encryption Key">CEK</abbr>). <em class="rfc2119">REQUIRED</em> when the OpenID Provider supports encryption of UserInfo responses. For more information, refer to <a href="#algorithms">Algorithms</a>.</li>
</ul>
<p><code>request_object_encryption_enc_values_supported</code></p>
<ul>
<li><em class="rfc2119">OPTIONAL</em>. <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> array containing the list of <abbr title="JSON Web Encryption">JWE</abbr> encryption algorithms (<code>enc</code> values) supported by the OpenID Provider for Request Objects to encrypt the Claims in a <abbr title="JSON Web Token">JWT</abbr> using the <abbr title="Content Encryption Key">CEK</abbr>. <em class="rfc2119">REQUIRED</em> when the OpenID Provider supports encryption of UserInfo responses. For more information, refer to <a href="#algorithms">Algorithms</a>.</li>
</ul>
<p><code>request_uri_parameter_supported</code></p>
<ul>
<li><em class="rfc2119">OPTIONAL</em>. Boolean value which specifies whether the OpenID Provider accepts Request Objects passed by reference using the <code>request_uri</code> parameter. As per [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>], the default value is <code>true</code>.</li>
</ul>
<p><code>require_request_uri_registration</code></p>
<ul>
<li><em class="rfc2119">REQUIRED</em> and <em class="rfc2119">MUST</em> have Boolean value <code>true</code> if the OpenID Provider accepts Request Objects passed by reference using the <code>request_uri</code> parameter. <em class="rfc2119">OPTIONAL</em> otherwise. This parameter indicates that <code>request_uri</code> values used by the Client to send Request Objects by reference must always be pre-registered.</li>
</ul>
<p><code>signed_metadata</code></p>
<ul>
<li><em class="rfc2119">RECOMMENDED</em>. A <abbr title="JSON Web Token">JWT</abbr>, signed using <abbr title="JSON Web Signature">JWS</abbr>, containing metadata values about the OpenID Provider as claims, as specified in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8414" title="OAuth 2.0 Authorization Server Metadata">RFC8414</a></cite>], Section 2.1.</li>
</ul>
<aside class="example" id="example-5"><div class="marker">
    <a class="self-link" href="#example-5">Example<bdi> 5</bdi></a>
  </div>
The following example shows the <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> document found at a discovery endpoint for an OpenID Provider:
<pre aria-busy="false"><code class="hljs javascript">{
  <span class="hljs-string">"request_parameter_supported"</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-string">"id_token_encryption_alg_values_supported"</span>: [
    <span class="hljs-string">"RSA-OAEP"</span>, <span class="hljs-string">"RSA-OAEP-256"</span>
  ],
  <span class="hljs-string">"registration_endpoint"</span>: <span class="hljs-string">"https://idp-p.example.com/register"</span>,
  <span class="hljs-string">"userinfo_signing_alg_values_supported"</span>: [
    <span class="hljs-string">"RS256"</span>, <span class="hljs-string">"RS384"</span>, <span class="hljs-string">"RS512"</span>
  ],
  <span class="hljs-string">"token_endpoint"</span>: <span class="hljs-string">"https://idp-p.example.com/token"</span>,
  <span class="hljs-string">"request_uri_parameter_supported"</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-string">"request_object_encryption_enc_values_supported"</span>: [
    <span class="hljs-string">"A192CBC-HS384"</span>, <span class="hljs-string">"A192GCM"</span>, <span class="hljs-string">"A256CBC+HS512"</span>,
    <span class="hljs-string">"A128CBC+HS256"</span>, <span class="hljs-string">"A256CBC-HS512"</span>,
    <span class="hljs-string">"A128CBC-HS256"</span>, <span class="hljs-string">"A128GCM"</span>, <span class="hljs-string">"A256GCM"</span>
  ],
  <span class="hljs-string">"token_endpoint_auth_methods_supported"</span>: [
    <span class="hljs-string">"private_key_jwt"</span>,
  ],
  <span class="hljs-string">"userinfo_encryption_alg_values_supported"</span>: [
    <span class="hljs-string">"RSA-OAEP"</span>, <span class="hljs-string">"RSA-OAEP-256"</span>
  ],
  <span class="hljs-string">"subject_types_supported"</span>: [
    <span class="hljs-string">"public"</span>, <span class="hljs-string">"pairwise"</span>
  ],
  <span class="hljs-string">"id_token_encryption_enc_values_supported"</span>: [
    <span class="hljs-string">"A192CBC-HS384"</span>, <span class="hljs-string">"A192GCM"</span>, <span class="hljs-string">"A256CBC+HS512"</span>,
    <span class="hljs-string">"A128CBC+HS256"</span>, <span class="hljs-string">"A256CBC-HS512"</span>, <span class="hljs-string">"A128CBC-HS256"</span>,
    <span class="hljs-string">"A128GCM"</span>, <span class="hljs-string">"A256GCM"</span>
  ],
  <span class="hljs-string">"claims_parameter_supported"</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-string">"jwks_uri"</span>: <span class="hljs-string">"https://idp-p.example.com/jwk"</span>,
  <span class="hljs-string">"id_token_signing_alg_values_supported"</span>: [
    <span class="hljs-string">"RS256"</span>, <span class="hljs-string">"RS384"</span>, <span class="hljs-string">"RS512"</span>
  ],
  <span class="hljs-string">"authorization_endpoint"</span>: <span class="hljs-string">"https://idp-p.example.com/authorize"</span>,
  <span class="hljs-string">"require_request_uri_registration"</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-string">"introspection_endpoint"</span>: <span class="hljs-string">"https://idp-p.example.com/introspect"</span>,
  <span class="hljs-string">"request_object_encryption_alg_values_supported"</span>: [
    <span class="hljs-string">"RSA-OAEP"</span>, <span class="hljs-string">"RSA-OAEP-256"</span>
  ],
  <span class="hljs-string">"service_documentation"</span>: <span class="hljs-string">"https://idp-p.example.com/about"</span>,
  <span class="hljs-string">"response_types_supported"</span>: [
    <span class="hljs-string">"code"</span>, <span class="hljs-string">"token"</span>
  ],
  <span class="hljs-string">"token_endpoint_auth_signing_alg_values_supported"</span>: [
    <span class="hljs-string">"RS256"</span>, <span class="hljs-string">"RS384"</span>, <span class="hljs-string">"RS512"</span>
  ],
  <span class="hljs-string">"revocation_endpoint"</span>: <span class="hljs-string">"https://idp-p.example.com/revoke"</span>,
  <span class="hljs-string">"request_object_signing_alg_values_supported"</span>: [
    <span class="hljs-string">"HS256"</span>, <span class="hljs-string">"HS384"</span>, <span class="hljs-string">"HS512"</span>, <span class="hljs-string">"RS256"</span>, <span class="hljs-string">"RS384"</span>, <span class="hljs-string">"RS512"</span>
  ],
  <span class="hljs-string">"claim_types_supported"</span>: [
    <span class="hljs-string">"normal"</span>
  ],
  <span class="hljs-string">"grant_types_supported"</span>: [
    <span class="hljs-string">"authorization_code"</span>,
  ],
  <span class="hljs-string">"scopes_supported"</span>: [
    <span class="hljs-string">"profile"</span>, <span class="hljs-string">"openid"</span>, <span class="hljs-string">"doc"</span>
  ],
  <span class="hljs-string">"userinfo_endpoint"</span>: <span class="hljs-string">"https://idp-p.example.com/userinfo"</span>,
  <span class="hljs-string">"userinfo_encryption_enc_values_supported"</span>: [
    <span class="hljs-string">"A192CBC-HS384"</span>, <span class="hljs-string">"A192GCM"</span>, <span class="hljs-string">"A256CBC+HS512"</span>,<span class="hljs-string">"A128CBC+HS256"</span>,
    <span class="hljs-string">"A256CBC-HS512"</span>, <span class="hljs-string">"A128CBC-HS256"</span>, <span class="hljs-string">"A128GCM"</span>, <span class="hljs-string">"A256GCM"</span>
  ],
  <span class="hljs-string">"op_tos_uri"</span>: <span class="hljs-string">"https://idp-p.example.com/about"</span>,
  <span class="hljs-string">"issuer"</span>: <span class="hljs-string">"https://idp-p.example.com/"</span>,
  <span class="hljs-string">"op_policy_uri"</span>: <span class="hljs-string">"https://idp-p.example.com/about"</span>,
  <span class="hljs-string">"claims_supported"</span>: [
    <span class="hljs-string">"sub"</span>, <span class="hljs-string">"name"</span>, <span class="hljs-string">"vot"</span>, <span class="hljs-string">"acr"</span>
  ],
  <span class="hljs-string">"acr_values_supported"</span> [
    <span class="hljs-string">"http://eidas.europa.eu/LoA/substantial"</span>,
    <span class="hljs-string">"http://eidas.europa.eu/LoA/high"</span>
  ]
}</code></pre>
</aside>

</section><section id="caching"><div class="header-wrapper"><h4 id="x5-4-3-caching"><bdi class="secno">5.4.3 </bdi>Caching</h4><a class="self-link" href="#caching" aria-label="Permalink for Section 5.4.3"></a></div>
<p>It is <em class="rfc2119">RECOMMENDED</em> that OpenID Providers provide caching directives through HTTP headers for the Discovery endpoint and the <code>jwks_uri</code> endpoint and make the cache valid for at least one week.
OpenID Providers <em class="rfc2119">SHOULD</em> document their change procedure. In order to support automated transitions to configuration updates, OpenID Providers <em class="rfc2119">SHOULD</em> only make non-breaking changes and retain backward compatibility when possible. It is <em class="rfc2119">RECOMMENDED</em> that OpenID Providers monitor usage of outdated configuration options used by any OpenID Client and actively work with their administrators to update configurations.
The above on caching and changes <em class="rfc2119">MUST</em> be applied to the <code>jwks_uri</code> containing the OpenID Provider's key set as well.</p>
</section><section id="public-keys"><div class="header-wrapper"><h4 id="x5-4-4-public-keys"><bdi class="secno">5.4.4 </bdi>Public keys</h4><a class="self-link" href="#public-keys" aria-label="Permalink for Section 5.4.4"></a></div>
<p>The OpenID Provider <em class="rfc2119">MUST</em> provide its public keys in JWK Set format, such as the following example JWK Set containing a PKIoverheid certificate chain and its 2048-bit RSA key (example certificates abbreviated):</p>
<aside class="example" id="example-6"><div class="marker">
    <a class="self-link" href="#example-6">Example<bdi> 6</bdi></a>
  </div>
  <pre aria-busy="false"><code class="hljs">{
  "keys": [
    {
      "alg": "RS256",
      "e": "AQAB",
      "n": "o80vbR0ZfMhjZWfqwPUGNkcIeUcweFyzB2S2T-hje83IOVct8gVg9Fx
            vHPK1ReEW3-p7-A8GNcLAuFP_8jPhiL6LyJC3F10aV9KPQFF-w6Eq6V
            tpEgYSfzvFegNiPtpMWd7C43EDwjQ-GrXMVCLrBYxZC-P1ShyxVBOze
            R_5MTC0JGiDTecr_2YT6o_3aE2SIJu4iNPgGh9MnyxdBo0Uf0TmrqEI
            abquXA1-V8iUihwfI8qjf3EujkYi7gXXelIo4_gipQYNjr4DBNl
            E0__RI0kDU-27mb6esswnP2WgHZQPsk779fTcNDBIcYgyLujlcUATEq
            fCaPDNp00J6AbY6w",
      "kty": "RSA",
      "kid": "rsa-PKIo",
      "x5c": [
        "MIIE3jCCA8agAwIBAgICAwEwDQYJKoZIhvcNAQEFBQAwYzELMAkGA
        1UEBhMCVVMxITAfBgNVBAoTGFRoZSBHbyBEYWRkeSBHcm91cCwgSW5
        jLjExMC8GA1UECxMoR2[...]TVSzGh6O1mawGhId/dQb8vxRMDsxux
        N89txJx9OjxUUAiKEngHUuHqDTMBqLdElrRhjZkAzVvb3du6/KFUJh
        eqwNTrZEjYx8WnM25sgVjOuH0aBsXBTWVU+4=",
        "MIIE+zCCBGSgAwIBAgICAQ0wDQYJKoZIhvcNAQEFBQAwgbsxJDAiB
        gNVBAcTG1ZhbGlDZXJ0IFZhbGlkYXRpb24gTmV0d29yazEXMBUGA1U
        EChMOVmFsaUNlcnQsIE[...]luYAzBgNVBAsTLFZhbGlDZXJ0IENsY
        XNzIDIgUG9saWN5IFZhbGlkYXRpb24gQXV0aG9yaXR5MSEwHwYDVQQ
        DExhodHRwOjZXRn453HWkrugp++85j09VZw==",
        "MIIC5zCCAlACAQEwDQYJKoZIhvcNAQEFBQAwgbsxJDAiBgNVBAcTG
        1ZhbGlDZXJ0IFZhbGlkYXRpb24gTmV0d29yazEXMBUGA1UEChMOVmF
        saUNlcnQsIEluYy4xNT[...]AzBgNVBAsTLFZhbGlDZXJ0IENsYXNz
        IDIgUG9saWN5IFZhbGlkYXRpb24gQXV0aMtsq2azSiGM5bUMMj4Qss
        xsodyamEwCW/POuZ6lcg5Ktz885hZo+L7tdEy8W9ViH0Pd"
      ],
      "use": "sig",
    }
  ]
}</code></pre>
</aside>

<p>In case PKIoverheid certificates are used, the certificate and entire certificate chain up until the root certificate <em class="rfc2119">MUST</em> be included as either an <code>x5c</code> or as <code>x5u</code> parameter, according to [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7517" title="JSON Web Key (JWK)">RFC7517</a></cite>] Sections 4.6 and 4.7. Parties <em class="rfc2119">SHOULD</em> support the inclusion of the certificate chain as <code>x5c</code> parameter, for maximum interoperability. Parties <em class="rfc2119">MAY</em> agree to use <code>x5u</code>, for instance for communication within specific environments.</p>
<p>The OpenID Provider <em class="rfc2119">SHOULD</em> utilize the approaches described in [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>], Sections 10.1.1 (signing keys) and 10.2.1 (encryption keys), to facilitate rotation of public keys.</p>
<p>Please refer to <a href="#algorithms">Algorithms</a> for more information on eligible cryptographic methods and keys that can be used by OpenID Providers.</p>
</section></section><section id="dynamic-registration"><div class="header-wrapper"><h3 id="x5-5-dynamic-registration"><bdi class="secno">5.5 </bdi>Dynamic Registration</h3><a class="self-link" href="#dynamic-registration" aria-label="Permalink for Section 5.5"></a></div>
<p>If the OpenID Provider is acting as an NL-Gov OAuth Authorization Server [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.nlgov" title="NL GOV Assurance profile for OAuth 2.0">OAuth2.NLGov</a></cite>], then Dynamic Registration <em class="rfc2119">MUST</em> be supported in accordance with Section 3.1.3 of that specification.</p>
<p>Dynamic Registration <em class="rfc2119">MUST</em> also be supported in combination with per-instance provisioning of secrets when registering Native Applications as confidential Clients.</p>
<p>In other cases, particularly when dealing with Browser-based applications or Native Apps, Dynamic Registration <em class="rfc2119">SHOULD</em> be supported in accordance with the NL GOV Assurance profile for OAuth 2.0 [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.nlgov" title="NL GOV Assurance profile for OAuth 2.0">OAuth2.NLGov</a></cite>].</p>
<p>This profile imposes the following requirements upon the Client Registration request:</p>
<p><code>Initial access tokens</code></p>
<ul>
<li>In cases where the OpenID Provider limits the parties that are allowed to register Clients using Dynamic Registration (i.e. when open registration is not applicable), the use of an initial access token in the form of an OAuth2 Bearer token using the <code>Authorization</code> HTTP header [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6750" title="The OAuth 2.0 Authorization Framework: Bearer Token Usage">RFC6750</a></cite>] is <em class="rfc2119">REQUIRED</em> for making Client Registration requests. In cases where open registration is applicable, the use of an initial access token is <em class="rfc2119">OPTIONAL</em>.</li>
</ul>
<p><code>redirect_uris</code></p>
<ul>
<li><p><em class="rfc2119">REQUIRED</em>. Array of Redirection <abbr title="Uniform Resource Identifier">URI</abbr> values used by the Client. <em class="rfc2119">MUST</em> be absolute HTTPS URLs. One of these registered Redirection <abbr title="Uniform Resource Identifier">URI</abbr> values <em class="rfc2119">MUST</em> exactly match the <code>redirect_uri</code> parameter value used in each Authorization Request.</p>
</li>
<li><p>The only exception is when the Client is a Native Application operating on a desktop device and is exclusively registered as such. In such cases:</p>
</li>
<li><p>the <code>redirect_uri</code> <em class="rfc2119">MAY</em> contain absolute HTTP URLs with the literal loopback IP addresses and port numbers the Client is listening on as hostnames. <em class="rfc2119">MUST NOT</em> use <code>localhost</code> as hostname for the loopback address, see [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8252" title="OAuth 2.0 for Native Apps">RFC8252</a></cite>] Sections 7.3 and 8.3; and</p>
</li>
<li><p>even though the port number is part of the registered <code>redirect_uri</code>, the OpenID Provider <em class="rfc2119">MUST</em> allow any port to be specified in the Authorization Request for loopback IP redirect URIs.</p>
</li>
</ul>
<p><code>jwks_uri</code> <em>or</em> <code>jwks</code></p>
<ul>
<li>Clients <em class="rfc2119">SHOULD</em> reference their <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> Web Key (JWK) Set via the <code>jwks_uri</code> parameter rather than passing their JWK Set document by value using the <code>jwks</code> parameter, as it allows for easier key rotation. Also, the <code>jwks</code> and <code>jwks_uri</code> parameters <em class="rfc2119">MUST NOT</em> both be present in the same request.</li>
</ul>
<p><code>subject_type</code></p>
<ul>
<li>For cases where correlation of End-User's activities across Clients is not appropriate, the <code>subject_type</code> parameter <em class="rfc2119">MUST</em> be set to <code>pairwise</code>. In other cases, the use of <code>pairwise</code> is <em class="rfc2119">RECOMMENDED</em> unless the use of public identifiers is required.</li>
</ul>
<p><code>request_uris</code></p>
<ul>
<li>Array of <code>request_uri</code> values that are pre-registered by the Client for use at the OpenID Provider. Clients that make Authentication Requests using the <code>request_uri</code> parameter, <em class="rfc2119">MUST</em> only do so via pre-registered <code>request_uri</code> values.</li>
</ul>
<p>Section 2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.dynamic-registration" title="OpenID Connect Dynamic Client Registration 1.0">OpenID.Dynamic-Registration</a></cite>] lists all Client Metadata values that are used by OpenID Connect. Note that additional parameters are defined in OAuth 2.0 Dynamic Client Registration Protocol ([<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7591" title="OAuth 2.0 Dynamic Client Registration Protocol">RFC7591</a></cite>]) can be relevant as well and <em class="rfc2119">MAY</em> be used.</p>
<aside class="example" id="example-7"><div class="marker">
    <a class="self-link" href="#example-7">Example<bdi> 7</bdi></a>
  </div>
An example of a Client registration request:
<pre aria-busy="false"><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/connect/register</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json
<span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>application/json
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>server.example.com
<span class="hljs-attribute">Authorization</span><span class="hljs-punctuation">: </span>Bearer eyJhbGciOiJSUzI1NiJ9.eyJ ...</code></pre>
<pre aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"application_type"</span>: <span class="hljs-string">"web"</span>,
  <span class="hljs-attr">"redirect_uris"</span>:
    [<span class="hljs-string">"https://client.example.org/callback"</span>,
    <span class="hljs-string">"https://client.example.org/callback2"</span>],
  <span class="hljs-attr">"client_name"</span>: <span class="hljs-string">"My Example"</span>,
  <span class="hljs-attr">"subject_type"</span>: <span class="hljs-string">"pairwise"</span>,
  <span class="hljs-attr">"sector_identifier_uri"</span>:
    <span class="hljs-string">"https://other.example.net/file_of_redirect_uris.json"</span>,
  <span class="hljs-attr">"token_endpoint_auth_method"</span>: <span class="hljs-string">"client_secret_basic"</span>,
  <span class="hljs-attr">"jwks_uri"</span>: <span class="hljs-string">"https://client.example.org/my_public_keys.jwks"</span>,
  <span class="hljs-attr">"userinfo_encrypted_response_alg"</span>: <span class="hljs-string">"RSA1_5"</span>,
  <span class="hljs-attr">"userinfo_encrypted_response_enc"</span>: <span class="hljs-string">"A128CBC-HS256"</span>,
  <span class="hljs-attr">"contacts"</span>: [<span class="hljs-string">"mary@example.org"</span>],
}</code></pre>
</aside>
Please refer to [Algorithms](#algorithms) for more information on eligible cryptographic methods and keys that can be used when registering a Client.</section></section><section id="user-info"><div class="header-wrapper"><h2 id="x6-user-info"><bdi class="secno">6. </bdi>User Info</h2><a class="self-link" href="#user-info" aria-label="Permalink for Section 6."></a></div>
<p>The availability, quality and reliability of an individual's identity attributes will vary greatly across jurisdictions and Provider systems. The following recommendations ensure maximum cross-jurisdictional interoperability, while setting Client expectations on the type of data they may acquire.</p>
<section id="claim-interoperability"><div class="header-wrapper"><h3 id="x6-1-claim-interoperability"><bdi class="secno">6.1 </bdi>Claim Interoperability</h3><a class="self-link" href="#claim-interoperability" aria-label="Permalink for Section 6.1"></a></div>
<p>As per Section 5.1.2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>], Claim names <em class="rfc2119">SHOULD</em> be collision-resistant. It is <em class="rfc2119">RECOMMENDED</em> to use domain name based URIs as attribute names.</p>
<p>[<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>] Section 5.1 specifies a list of standard Claims. In a Dutch governmental context, attribute Claims are commonly registered in the <abbr title="Basis Registratie Personen, the Dutch citizen registry">BRP</abbr> (<em>Basis Registratie Personen</em>, the Dutch citizen registry), as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-lo.gba" title=" Logisch ontwerp BRP">LO.GBA</a></cite>]. Note that some of the standard Claims of OpenID Connect do not map directly or correctly with <abbr title="Basis Registratie Personen, the Dutch citizen registry">BRP</abbr> attributes. <abbr title="Basis Registratie Personen, the Dutch citizen registry">BRP</abbr> attributes <em class="rfc2119">SHOULD</em> be prefered over OpenID Connect claims for attributes.
Additionally, usage of, or interoperability with, the ISA<sup>2</sup> core vocabularies is <em class="rfc2119">RECOMMENDED</em>.</p>
</section><section id="claims-supported"><div class="header-wrapper"><h3 id="x6-2-claims-supported"><bdi class="secno">6.2 </bdi>Claims Supported</h3><a class="self-link" href="#claims-supported" aria-label="Permalink for Section 6.2"></a></div>
<p>Discovery requires including the <code>claims_supported</code> field, which defines the Claims a Client <em class="rfc2119">MAY</em> expect to receive for the supported scopes. OpenID Providers <em class="rfc2119">MUST</em> return Claims on a best effort basis. However, an OpenID Provider asserting it can provide an End-User Claim does not imply that this data is available for all its End-Users: Clients <em class="rfc2119">MUST</em> be prepared to receive partial data.
OpenID Providers <em class="rfc2119">MAY</em> return Claims outside of the <code>claims_supported</code> list, but they <em class="rfc2119">MUST</em> still ensure that the extra Claims to not violate the privacy policies set out by the trust framework the Provider supports. The OpenID Provider <em class="rfc2119">MUST</em> ensure to comply with applicable privacy legislation (e.g. informed consent as per <abbr title="General Data Protection Regulation">GDPR</abbr>) at all times.</p>
<blockquote>
<p>Note that when Representation is supported, the OpenID Provider <em class="rfc2119">MUST</em> include <code>represents</code> in the list of supported Claims and <em class="rfc2119">MAY</em> include nested Claims inside the <code>represents</code> Claim.</p>
</blockquote>
</section><section id="scope-profiles"><div class="header-wrapper"><h3 id="x6-3-scope-profiles"><bdi class="secno">6.3 </bdi>Scope Profiles</h3><a class="self-link" href="#scope-profiles" aria-label="Permalink for Section 6.3"></a></div>
<p>In the interests of data minimization balanced with the requirement to successfully identify the individual signing in to a service, the default OpenID Connect scope profiles to request Claims ([<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>] Section <a href="https://openid.net/specs/openid-connect-core-1_0.html#ScopeClaims">5.4</a>) may not be appropriate.</p>
<p>Matching of the identity assertion based on Claims to a local identifier or <code>account</code> related to the individual identity at a Level of Assurance is a requirement where the government in question is not able to provide a single identifier for all citizens based on an authoritative register of citizens.</p>
<p>The requirement for matching is also of importance where a cross-border or cross-jurisdiction authentication is required and therefore the availability of a single identifier (e.g. social security number) cannot be guaranteed for the individual wishing to authenticate.</p>
<p>However, in the Netherlands the <abbr title="Burgerservicenummer, the identification number for citizen in The Netherlands">BSN</abbr> is, as a common identifier for citizens, available to <abbr title="Burgerservicenummer, the identification number for citizen in The Netherlands">BSN</abbr>-eligible organizations. Nationwide interoperable pseudonyms per OpenID Client for non-<abbr title="Burgerservicenummer, the identification number for citizen in The Netherlands">BSN</abbr>-eligible organizations exist as well.</p>
<p>The default <code>profile</code> scope of OpenID Connect is very wide, which is undesired from a privacy perspective. As such, the <code>profile</code> scope <em class="rfc2119">SHOULD NOT</em> be used.</p>
<blockquote>
<p>Note that the <code>doc</code> profile described in the iGov profile for OpenID Connect [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.igov" title="International Government Assurance Profile (iGov) for OpenID Connect 1.0">OpenID.iGov</a></cite>] is not in common use in the Netherlands and therefore not included in this profile.</p>
</blockquote>
</section><section id="claims-request"><div class="header-wrapper"><h3 id="x6-4-claims-request"><bdi class="secno">6.4 </bdi>Claims Request</h3><a class="self-link" href="#claims-request" aria-label="Permalink for Section 6.4"></a></div>
<p>OpenID Core Section 5.5 [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>] defines a method for a Client to request specific Claims in the UserInfo object or ID Token. OpenID Providers <em class="rfc2119">MUST</em> support this <code>claims</code> parameter in the interest of data minimization - that is, the Provider only returns information on the subject the Client specifically asks for, and does not volunteer additional information about the subject.</p>
<p>Clients requesting the <code>profile</code> scope <em class="rfc2119">MAY</em> provide a <code>claims</code> request parameter.
If the Claims request is omitted, the OpenID Provider <em class="rfc2119">SHOULD</em> provide a default Claims set that it has available for the subject, in accordance with any policies set out by the trust framework the Provider supports.</p>
<blockquote>
<p><strong>Note:</strong> Clients <em class="rfc2119">SHOULD NOT</em> request the <code>profile</code> scope, as described in the previous section.</p>
</blockquote>
</section><section id="claims-response"><div class="header-wrapper"><h3 id="x6-5-claims-response"><bdi class="secno">6.5 </bdi>Claims Response</h3><a class="self-link" href="#claims-response" aria-label="Permalink for Section 6.5"></a></div>
<p>Response to a UserInfo request <em class="rfc2119">MUST</em> match the scope and Claims requested to avoid having a OpenID Provider over-expose an End-User's identity information.
OpenID Providers <em class="rfc2119">MUST NOT</em> provide any personal identifiable information without applicable consent.</p>
<p>Claims responses <em class="rfc2119">MAY</em> also make use of the aggregated and/or distributed Claims structure to refer to the original source of the subject's Claims.</p>
</section><section id="claims-metadata"><div class="header-wrapper"><h3 id="x6-6-claims-metadata"><bdi class="secno">6.6 </bdi>Claims Metadata</h3><a class="self-link" href="#claims-metadata" aria-label="Permalink for Section 6.6"></a></div>
<p>Claims Metadata (such as locale or the confidence level the OpenID Provider has in the Claim for the End-User) can be expressed as attributes within the UserInfo object, but are outside the scope of this document. These types of Claims are best described by the trust framework the Clients and OpenID Providers operate within.
It is up to the Client to assess the level of confidence provided by the OpenID Provider or the trust framework, per Claim. Expressing or evaluating such confidence is beyond the scope of this profile.</p>
<p>In order to provide a source, including integrity and optionally confidentiality, an OpenID Provider <em class="rfc2119">SHOULD</em> be able to provide aggregated or support distributed Claims. The signee of such aggregated or distributed Claims implies the source and can support in assessing the level confidence or quality of the Claim.</p>
</section></section><section id="considerations"><div class="header-wrapper"><h2 id="x7-considerations"><bdi class="secno">7. </bdi>Considerations</h2><a class="self-link" href="#considerations" aria-label="Permalink for Section 7."></a></div>
<section id="privacy-considerations"><div class="header-wrapper"><h3 id="x7-1-privacy-considerations"><bdi class="secno">7.1 </bdi>Privacy considerations</h3><a class="self-link" href="#privacy-considerations" aria-label="Permalink for Section 7.1"></a></div>
<p>Data minimization is an essential concept in trust frameworks and federations exchanging End-User identity information for government applications.
The design of this profile takes into consideration mechanisms to protect the End-User's government identity information and activity from unintentional exposure.</p>
<p>Pairwise Subject identifiers <em class="rfc2119">MUST</em> be supported by the OpenID Providers for frameworks where subjects should not be traceable or linkable across Clients by their Subject ID. This prevents situations where an End-User may inadvertently be assigned a universal government identifier.</p>
<p>Request Claims using the <code>claim</code> parameter <em class="rfc2119">MUST</em> be supported by OpenID Providers to ensure that only the data the Client explicitly requests is provided in the UserInfo response or ID Token.
This prevents situations where a Client may only require a partial set of Claims, but receives (and is therefore exposed to) a full set of Claims. For example, if a Client only needs an identifier and the persons legal age, the OpenID Provider <em class="rfc2119">MUST NOT</em> send the Client the full user name and birth date.
Similarly, broad attribute requests through the <code>scope</code> parameter, such as <code>profile</code> <em class="rfc2119">SHOULD NOT</em> be used.</p>
<p>All Clients <em class="rfc2119">MUST</em> apply the concept of data minimization. As a result, a Client <em class="rfc2119">MUST NOT</em> request any more identifiers, attributes or other Claims than strictly necessary.
Additionally, Clients <em class="rfc2119">SHOULD</em> ensure they minimize the scope and audience they request, use and forward. This principle applies to both to usage at the Client as well as forwarded Access Tokens in a Service Intermediation scenario.
Token Exchange [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8693" title="OAuth 2.0 Token Exchange">RFC8693</a></cite>] <em class="rfc2119">SHOULD</em> be used to request Access Tokens with a minimal scope and audience.</p>
<blockquote>
<p>Note that per-instance registration of Native Clients can increase the risk of Client -- and thus End-User -- observability and traceability. This because the <code>client_id</code> is unique, can be linked to an individual and may be observed. The <code>client_id</code> <em class="rfc2119">SHOULD</em> be considered and treated as sensitive data in case per-instance registration is applied.
Although the <code>client_id</code> will be protected by TLS, it may be exposed at the Client itself or the OpenID Provider or elsewhere. As mitigating measure, implementations <em class="rfc2119">MAY</em> use encrypted request objects and tokens.
OpenID Providers <em class="rfc2119">SHOULD</em> assign unpredictable Client Identifiers in case of per-instance registration for Native Clients, in order to mitigate guessing and (cross Client and cross audience) linkability of Client Identifiers.</p>
</blockquote>
<p>In order to provide end-to-end security and privacy, identifiers and attributes <em class="rfc2119">SHOULD</em> be encrypted from the providing source to the ultimate intended recipient. This can be accomplished by either encrypting entire response messages and tokens or by using aggregated or distributed Claims (see Section 5.6.2 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.core" title="OpenID Connect Core 1.0">OpenID.Core</a></cite>]). Applying end-to-end encryption is strongly <em class="rfc2119">RECOMMENDED</em> for both the <abbr title="Burgerservicenummer, the identification number for citizen in The Netherlands">BSN</abbr> (<em>Burgerservicenummer</em>, the Dutch citizen ID) and sensitive attributes.</p>
<p>Despite the mechanisms enforced by this profile, the operational circumstances may allow these controls to be relaxed in a specific context.
For example, if a bilateral agreement between two agencies legally entitles usage of citizen identifiers, then the Pairwise Pseudonymous Identifier requirement may be relaxed. In cases where all Clients are entitled to process Claims associated to a subject at an OpenID Provider, the Claims request requirement may be relaxed.</p>
<p>The reasons for relaxing the controls that support data minimization are outside the scope of this profile.</p>
</section><section id="security-considerations"><div class="header-wrapper"><h3 id="x7-2-security-considerations"><bdi class="secno">7.2 </bdi>Security considerations</h3><a class="self-link" href="#security-considerations" aria-label="Permalink for Section 7.2"></a></div>
<p>Implementations of this profile or any form of access to a service, <em class="rfc2119">MUST</em> make a risk assessment or security classification for that service and the information disclosed. It is strongly <em class="rfc2119">RECOMMENDED</em> to follow the guide 'Assurance level for digital service provision' [<cite><a class="bibref" data-link-type="biblio" href="#bib-sg.loa" title="Assurance level for digital service provision">SG.LoA</a></cite>].
Particularly when implementing for higher levels of assurance (e.g. <abbr title="Electronic Identification, Authentication and Trust Services">eIDAS</abbr> "high" or "substantial"), requirements specified as <em class="rfc2119">SHOULD</em> (NOT) or (NOT) <em class="rfc2119">RECOMMENDED</em> in this profile are more pertinent to implement accordingly. In line with the scope of the "Assurance level for digital service provision" guide, information and services classified as "state secret" (Dutch: "<em>staatsgeheim</em>") are out of scope for implementations under this profile.</p>
<p>An OpenID Provider <em class="rfc2119">MUST</em> use a distinct Client Identifier (<code>client_id</code>) and registration for each unique Client. This in particular applies to public Clients, these registrations <em class="rfc2119">MUST NOT</em> be shared with confidential Clients, even if they are operated by the same organisation.
Distinct registrations <em class="rfc2119">MAY</em> be applied to different versions of (native and browser-based public) Clients as well. This will allow a form of support for version management, noting that this can not be considered a very reliable method from a security point of view.</p>
<p>Refresh Tokens <em class="rfc2119">SHOULD</em> only be applied and enabled when a functional need exists. Support for Refresh Tokens <em class="rfc2119">SHOULD</em> therefore be disabled by default.
Refresh Tokens for confidential Clients <em class="rfc2119">MUST</em> be sender-constrained by the issuing OpenID Provider. How the <abbr title="OpenID Provider">OP</abbr> accomplishes this is implementation specific, suggestions can be found in [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.1" title="OAuth 2.1 Working draft">OAuth2.1</a></cite>], Section 6.1.
Using Refresh Tokens in combination with public Clients <em class="rfc2119">SHOULD</em> be avoided when possible. If a specific scenario does call for usage of Refresh Tokens with public Clients, Refresh Tokens <em class="rfc2119">MUST</em> rotate on each use with a limited valid lifetime.</p>
<p>All transactions <em class="rfc2119">MUST</em> be protected in transit by TLS as described in BCP195 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7525" title="Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)">RFC7525</a></cite>]. In addition, all compliant implementations <em class="rfc2119">MUST</em> apply the IT Security Guidelines for TLS by the Dutch NCSC [<cite><a class="bibref" data-link-type="biblio" href="#bib-sg.tls" title=" IT Security Guidelines for Transport Layer Security (TLS)">SG.TLS</a></cite>]. Implementations <em class="rfc2119">SHOULD</em> only implement settings and options indicated as "good", <em class="rfc2119">SHOULD NOT</em> use any settings with a status "phase out" and <em class="rfc2119">MUST NOT</em> use any setting with a status "insufficient" in these security guidelines or future updates thereof.</p>
<p>Implementations <em class="rfc2119">MUST</em> implement 'HTTP Strict Transport Security', as specified in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6797" title="HTTP Strict Transport Security (HSTS)">RFC6797</a></cite>].</p>
<p>All Clients <em class="rfc2119">MUST</em> conform to applicable recommendations found in the 'Security Considerations' sections of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6749" title="The OAuth 2.0 Authorization Framework">RFC6749</a></cite>] and those found in 'OAuth 2.0 Threat Model and Security Considerations' [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6819" title="OAuth 2.0 Threat Model and Security Considerations">RFC6819</a></cite>]. For all Tokens, the '<abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr> Web Token Best Current Practices' [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8725" title="JSON Web Token Best Current Practices">RFC8725</a></cite>] <em class="rfc2119">SHOULD</em> be applied.</p>
<p>All Clients <em class="rfc2119">MUST</em> apply cross-site request forgery (<abbr title="Cross Site Request Forgery">CSRF</abbr>) counter measures. Clients can leverage the OpenID Connect <code>nonce</code> and OAuth2 <code>state</code> parameters to do so. A Client <em class="rfc2119">MUST</em> utilize one or more of these parameters to verify an Authentication Response matches with the Authentication Request sent. After first use, the Client <em class="rfc2119">SHOULD</em> invalidate the parameter so it can be used only once (see [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.security" title="OAuth 2.0 Security Best Current Practice">OAuth2.Security</a></cite>], Section 4.2.4).</p>
<p>In case Clients are relying on and communicating with multiple OpenID Providers (and/or OAuth2 Authorization Servers), Clients <em class="rfc2119">MUST</em> implement countermeasures to prevent mix-up attacks. Clients <em class="rfc2119">SHOULD</em> at least use distinct redirect URIs for each OpenID Provider / Authorization Server, or alternatively validate the issuer (<code>iss</code>) in the response (ID Token) matches the initiating Authentication Request (see [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8252" title="OAuth 2.0 for Native Apps">RFC8252</a></cite>], Section 8.10 and [<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.security" title="OAuth 2.0 Security Best Current Practice">OAuth2.Security</a></cite>], Section 2.1 and 4.4.2).</p>

<section id="algorithms"><div class="header-wrapper"><h4 id="x7-2-1-algorithms"><bdi class="secno">7.2.1 </bdi>Algorithms</h4><a class="self-link" href="#algorithms" aria-label="Permalink for Section 7.2.1"></a></div>
<p>Security of OpenID Connect and OAuth 2.0 is significantly based on the application of cryptography. Herein the choice of algorithms is important for both security as well as interoperability. This section lists relevant choices of algorithms for all messages and tokens.</p>
<p>For signing of messages and tokens, implementations:</p>
<ul>
<li><em class="rfc2119">MUST</em> support <code>RS256</code>.</li>
<li><em class="rfc2119">SHOULD</em> support <code>PS256</code>; usage of <code>PS256</code> is <em class="rfc2119">RECOMMENDED</em> over <code>RS256</code>.</li>
<li><em class="rfc2119">MAY</em> support other algorithms, provided they are at least equally secure as <code>RS256</code>.</li>
<li><em class="rfc2119">MUST NOT</em> support algorithms that are less secure than <code>RS256</code>.</li>
</ul>
<p>For asymmetric encryption, in particular encryption of content encryption keys, implementations:</p>
<ul>
<li><em class="rfc2119">MUST</em> support <code>RSA-OAEP</code>.</li>
<li><em class="rfc2119">SHOULD</em> support <code>RSA-OAEP-256</code>.</li>
<li><em class="rfc2119">MAY</em> support other algorithms, provided they are at least equally secure as <code>RSA-OAEP</code>.</li>
<li><em class="rfc2119">MUST NOT</em> support algorithms that are less secure than <code>RSA-OAEP</code>.</li>
</ul>
<p>For symmetric encryption, implementations:</p>
<ul>
<li><em class="rfc2119">MUST</em> support <code>A256GCM</code>.</li>
<li><em class="rfc2119">MAY</em> support other algorithms, provided they are at least equally secure as <code>A256GCM</code>.</li>
<li><em class="rfc2119">MUST NOT</em> support algorithms that are less secure than <code>A256GCM</code>.</li>
</ul>
<p>In addition to proper selection and configuration of algorithms, implementations <em class="rfc2119">MUST</em> ensure to use a cryptographically secure (pseudo)random generator. Administrators and implementations <em class="rfc2119">MUST</em> apply industry best practices for key management of cryptographic keys. This includes best practices for selection of applicable key length as applicable for the relevant algorithm(s) selected.</p>
</section></section><section id="future-updates"><div class="header-wrapper"><h3 id="x7-3-future-updates"><bdi class="secno">7.3 </bdi>Future updates</h3><a class="self-link" href="#future-updates" aria-label="Permalink for Section 7.3"></a></div>
<p>This profile was created using published, finalized specifications and standards as basis. Some relevant new documents are under development at the time of writing. As this profile does not use any draft documents as basis, these cannot be included.
However, we want to attend readers to these developments and for them to take into account that future updates to this profile may incorporate the resulting standards and specifications. Furthermore we would like encourage readers to follow relevant developments.</p>
<section id="service-intermediation"><div class="header-wrapper"><h4 id="x7-3-1-service-intermediation"><bdi class="secno">7.3.1 </bdi>Service Intermediation</h4><a class="self-link" href="#service-intermediation" aria-label="Permalink for Section 7.3.1"></a></div>
<p>One functionality that is widely used in the (semi-)governmental sector but is not included in the initial version of this profile specification is <em>Service Intermediation</em>. This scenario is sometimes also refered to as identity propagation.
Examples of Service Intermediation scenario's include portals, API aggregators and Clients with enhanched or automated assistence for consuming services.</p>
<p>Service Intermediation is applicable when the Service Provider does not directly interact with the End-User, but delegates this responsibility to a Service Intermediary. The Service Intermediary therefore interacts with the OpenID Provider for End-User authentication, with the service offered by the Serivce Provider in scope of the Authentication Request. The Service Provider can now rely on a token from the OpenID Provider received via the Service Intermediary. Note that there is interaction with OAuth2, the Service Provider acts as Resource Server.</p>
<p>Such a Service Intermediary can intermediate a single service offered by a single Service Provider (e.g. an accounting app (service) that has an option to submit a tax declaration) or it can aggregate multiple Services offered by multiple Service Providers using intermediation (e.g. an app that aggregates your health information stored at several health organisations).</p>
<p>It is anticipated that support for Service Intermediation will be added in a later version of this profile; when it will, the following should be considered:</p>
<ul>
<li>Service Intermediaries should be able to obtain Claims and subject identifiers for different intermediated Services via different interactions with the OpenID Provider, with End-User consent but without the need of complete re-authentication.</li>
<li>Service Intermediaries are generally not allowed to access Claims and subject identifiers. Hence, the use of pairwise and encrypted subject identifiers and Claims is usually required.</li>
<li>Service Providers control which Service Intermediaries they support, specifically when confidential information is involved. Hence, Client Registration with the OpenID Provider must be established such that Service Intermediaries can only intermediate (and request Claims and subject identifiers for) Services that they are authorized for. A potential solution direction could be the use of Proof-of-Possession Key Semantics, as described in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7800" title="Proof-of-Possession Key Semantics for JSON Web Tokens (JWTs)">RFC7800</a></cite>].</li>
</ul>
</section><section id="federations"><div class="header-wrapper"><h4 id="x7-3-2-federations"><bdi class="secno">7.3.2 </bdi>Federations</h4><a class="self-link" href="#federations" aria-label="Permalink for Section 7.3.2"></a></div>
<p>This profile acknowledges that federations are widely in use, in particular among (semi-)governmental and public domain orgranisations. However, no specific support or requirements for federations are included in this version of this profile.
The OpenID Foundation is currently drafting a specification for explicit support of federations using OpenID Connect. Future updates to this profile may adopt such federation specificaitons once finalized. See <a href="https://openid.net/tag/federation/">Federation at the OpenID Foundation</a>.</p>
</section><section id="other-features"><div class="header-wrapper"><h4 id="x7-3-3-other-features"><bdi class="secno">7.3.3 </bdi>Other features</h4><a class="self-link" href="#other-features" aria-label="Permalink for Section 7.3.3"></a></div>
<p>The following overview lists <abbr title="Request For Change">RFC</abbr> and <abbr title="Best Current Practice">BCP</abbr> documents being drafted by the OAuth 2.0 working group of the Internet Engineering Task Force (<abbr title="Internet Engineering Task Force">IETF</abbr>) and work-in-progress by the OpenID Foundation. Future updates to this profile are likely to seek usage of and interoperability with these specifications once finalized.</p>
<p>[<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.jwt" title="JSON Web Token (JWT) Profile for OAuth 2.0 Access Tokens">OAuth2.JWT</a></cite>]</p>
<ul>
<li>An <abbr title="Request For Change">RFC</abbr> for Access Tokens in <abbr title="JSON Web Token">JWT</abbr> format is being drafted in the OAuth 2.0 working group at <abbr title="Internet Engineering Task Force">IETF</abbr>.</li>
</ul>
<p>[<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.jar" title="The OAuth 2.0 Authorization Framework: JWT Secured Authorization Request (JAR)">OAuth2.JAR</a></cite>]</p>
<ul>
<li>An <abbr title="Request For Change">RFC</abbr> for Secured (signed and/or encrypted) Authorization Requests is being drafted in the OAuth 2.0 working group at <abbr title="Internet Engineering Task Force">IETF</abbr>. Most of the practices described in this <abbr title="Request For Change">RFC</abbr> are already part of the OpenID Connect Core specification.</li>
</ul>
<p>[<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.rar" title="OAuth 2.0 Rich Authorization Requests">OAuth2.RAR</a></cite>]</p>
<ul>
<li>An <abbr title="Request For Change">RFC</abbr> that introduces a request parameter <code>authorization_details</code>, which allows for more expressive Authentication Requests than those possible with the <code>scope</code> parameter, is being drafted in the OAuth 2.0 working group at <abbr title="Internet Engineering Task Force">IETF</abbr>.</li>
</ul>
<p>[<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.par" title="OAuth 2.0 Pushed Authorization Requests">OAuth2.PAR</a></cite>]</p>
<ul>
<li>An <abbr title="Request For Change">RFC</abbr> that introduces an endpoint to which Clients can push Authorization Requests via a direct POST request to an Authorizaton Server, prior to forwarding the End-User with a <code>request_uri</code> referencing the request to the Authorization Server, is being drafted in the OAuth 2.0 working group at <abbr title="Internet Engineering Task Force">IETF</abbr>. The practices described in this <abbr title="Request For Change">RFC</abbr> are already part of the OpenID Connect Core specification.</li>
</ul>
<p>[<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.security" title="OAuth 2.0 Security Best Current Practice">OAuth2.Security</a></cite>]</p>
<ul>
<li>A Best Current Practice document that extends the OAuth 2.0 Security Threat Model and provides security recommendations to address security challenges in OAuth 2.0 is being drafted in the OAuth 2.0 working group at <abbr title="Internet Engineering Task Force">IETF</abbr>.</li>
</ul>
<p>[<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.browser-based-apps" title="OAuth 2.0 for Browser-Based Apps">OAuth2.Browser-Based-Apps</a></cite>]</p>
<ul>
<li>A Best Current Practice document that details security considerations and best practices to be taken into account when implementing browser-based applications that use OAuth 2.0 is being drafted in the OAuth 2.0 working group at <abbr title="Internet Engineering Task Force">IETF</abbr>.</li>
</ul>
<p>[<cite><a class="bibref" data-link-type="biblio" href="#bib-oauth2.1" title="OAuth 2.1 Working draft">OAuth2.1</a></cite>]</p>
<ul>
<li>An effort to consolidate and simplify OAuth 2.0 by adding and removing functionality of the core OAuth 2.0 specification and by incorporating several RFCs and BCPs that were built upon OAuth 2.0.</li>
</ul>
<p>[<cite><a class="bibref" data-link-type="biblio" href="#bib-openid.federation" title="OpenID Connect Federation 1.0 - draft 12">OpenID.Federation</a></cite>]</p>
<ul>
<li>Work by the OpenID Foundation to support federations of OpenID Providers and relying Service Providers, by publishing aggregated metadata in a specified format.</li>
</ul>
</section></section></section><section class="informative" id="glossary"><div class="header-wrapper"><h2 id="x8-glossary"><bdi class="secno">8. </bdi>Glossary</h2><a class="self-link" href="#glossary" aria-label="Permalink for Section 8."></a></div><p><em>This section is non-normative.</em></p>
<p>The following terms that are specific to this profile or its functional context are used throughout this specification:</p>
<p>Representation</p>
<blockquote>
<p>The action of one party acting on behalf of another party through delegated authority, which was given voluntary or based on legal grounds. Both parties can either be natural or juridical persons.</p>
</blockquote>
<p>Representation Relationship</p>
<blockquote>
<p>When one party represents another party, both parties have a Representation Relationship. Typically a Representation Relationship needs to be formally documented in order to be useable in automated processes, resulting in a statement or registration of the Representation Relationship.</p>
</blockquote>
<p><abbr title="Electronic Identification, Authentication and Trust Services">eIDAS</abbr></p>
<blockquote>
<p><abbr title="Electronic Identification, Authentication and Trust Services">eIDAS</abbr> (Electronic Identification, Authentication and Trust Services) is an <abbr title="European Union">EU</abbr> regulation on electronic identification and trust services for electronic transactions in the European Union.</p>
</blockquote>

<div style="display:none">
    <abbr title="Best Current Practice">BCP</abbr>
    <abbr title="Basis Registratie Personen, the Dutch citizen registry">BRP</abbr>
    <abbr title="Burgerservicenummer, the identification number for citizen in The Netherlands">BSN</abbr>
    <abbr title="Content Encryption Key">CEK</abbr>
    <abbr title="Cross Site Request Forgery">CSRF</abbr>
    <abbr title="European Union">EU</abbr>
    <abbr title="General Data Protection Regulation">GDPR</abbr>
    <abbr title="Internet Engineering Task Force">IETF</abbr>
    <abbr title="Identity Provider">IdP</abbr>
    <abbr title="JavaScript Object Notation, a lightweight data-exchange format often used with REST APIs">JSON</abbr>
    <abbr title="JSON Web Token">JWT</abbr>
    <abbr title="JSON Web Signature">JWS</abbr>
    <abbr title="JSON Web Encryption">JWE</abbr>
    <abbr title="Kamer van Koophandel, the Dutch Chamber of Commerce">KvK</abbr>
    <abbr title="Level of Assurance">LoA</abbr>
    <abbr title="OpenID Provider">OP</abbr>
    <abbr title="Proof Key for Code Exchange">PKCE</abbr>
    <abbr title="Risk Based Authentication">RBA</abbr>
    <abbr title="Request For Change">RFC</abbr>
    <abbr title="Relying Party">RP</abbr>
    <abbr title="Rechtspersonen en Samenwerkingsverbanden Identificatienummer, the identification number for legal entities and associations in The Netherlands">RSIN</abbr>
    <abbr title="Uniform Resource Identifier">URI</abbr>
    <abbr title="Cross-Site Scripting">XSS</abbr>
</div>

<section id="notices"><div class="header-wrapper"><h3 id="x8-1-notices"><bdi class="secno">8.1 </bdi>Notices</h3><a class="self-link" href="#notices" aria-label="Permalink for Section 8.1"></a></div>
<p>The technology described in this specification was made available from contributions from various sources, including members of the OpenID Foundation (OIDF), the Internet Engineering Task Force (<abbr title="Internet Engineering Task Force">IETF</abbr>) and others.</p>
</section><section id="acknowledgements"><div class="header-wrapper"><h3 id="x8-2-acknowledgements"><bdi class="secno">8.2 </bdi>Acknowledgements</h3><a class="self-link" href="#acknowledgements" aria-label="Permalink for Section 8.2"></a></div>
<p>Special thanks go to the following people for their involvement in the working group and for their contributions to the specification:</p>
<i>

<p>Anouschka Biekman (Logius), Arjen Monster (Gemeente Den Haag), Arnout van Velzen (Logius/RV), Bart Geesink (Surfnet), Bart Kerver (VWS), Bob te Riele (RVIG), Dennis Reumer (RVO), Dolf Smits (Belastingdienst), Elsbeth Bodde (iShare), Erwin Reinout (Kennisnet), Frank van Es (Logius), Frans de Kok (Logius/ETD), Jan Geert Koops (Dictu), Jan Jaap Zoutendijk (CIV), Jeroen de Ruig (Lost Lemon), Joost van Dijk (Surfnet), Joris Joosten (VZVZ/MedMij), Lakeshia Tjin Liep Shie (Logius), Mark Nijmeijer (Justid), Martin Borgman (Kadaster), Peter Haasnoot (Logius/CvS), Peter Kooi (Belastingdienst), Pieter Heering (Logius), Redouan Ahaloui (Forum Standaardisatie), Remco Schaar (Logius), Rob Post (RVIG), Robin Gelhard (Forum Standaardisatie), Timen Olthof (VNG), and Victor den Bak (iShare).</p>
</i></section></section>
  <script>
    let content = "";

    const getClass = function(key) {
      if (respecConfig.content[key]!==""){return <code> class="${respecConfig.content[key]}"</code>}
    }

    for (let contentKey in respecConfig.content) {
      content += <code>&lt;section data-include-format="markdown" data-include="${contentKey}.md" ${getClass(contentKey)||""}&gt;&lt;/section&gt;</code>
    }

    document.getElementById("sotd").insertAdjacentHTML('afterend', content);
  </script>
  <section id="conformance"><div class="header-wrapper"><h2 id="x9-conformance"><bdi class="secno">9. </bdi>Conformance</h2><a class="self-link" href="#conformance" aria-label="Permalink for Section 9."></a></div><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p><p>
        The key words <em class="rfc2119">MAY</em>, <em class="rfc2119">MUST</em>, <em class="rfc2119">MUST NOT</em>, <em class="rfc2119">NOT RECOMMENDED</em>, <em class="rfc2119">OPTIONAL</em>, <em class="rfc2119">RECOMMENDED</em>, <em class="rfc2119">REQUIRED</em>, <em class="rfc2119">SHALL</em>, <em class="rfc2119">SHALL NOT</em>, <em class="rfc2119">SHOULD</em>, and <em class="rfc2119">SHOULD NOT</em> in this document
        are to be interpreted as described in
        <a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
        when, and only when, they appear in all capitals, as shown here.
      </p></section>
  <section id="tof"><div class="header-wrapper"><h2 id="x10-list-of-figures"><bdi class="secno">10. </bdi>List of Figures</h2><a class="self-link" href="#tof" aria-label="Permalink for Section 10."></a></div><ul class="tof">
        <li class="tofline">
    <a class="tocxref" href="#authorization_code_flow"><span class="self-link">Figure <bdi class="figno">1</bdi></span> <span class="fig-title">Authorization Code Flow</span></a>
  </li>
      </ul></section>
  <section id="index" class="appendix"><div class="header-wrapper"><h2 id="a-index"><bdi class="secno">A. </bdi>Index</h2><a class="self-link" href="#index" aria-label="Permalink for Appendix A."></a></div><section id="index-defined-here">
    <div class="header-wrapper"><h3 id="a-1-terms-defined-by-this-specification"><bdi class="secno">A.1 </bdi>Terms defined by this specification</h3><a class="self-link" href="#index-defined-here" aria-label="Permalink for Appendix A.1"></a></div>
    <ul class="index">
    
  </ul>
  </section><section id="index-defined-elsewhere">
    <div class="header-wrapper"><h3 id="a-2-terms-defined-by-reference"><bdi class="secno">A.2 </bdi>Terms defined by reference</h3><a class="self-link" href="#index-defined-elsewhere" aria-label="Permalink for Appendix A.2"></a></div>
    <ul class="index">
    
  </ul>
  </section></section>



<section id="references" class="appendix"><div class="header-wrapper"><h2 id="b-references"><bdi class="secno">B. </bdi>References</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix B."></a></div><section id="normative-references">
    <div class="header-wrapper"><h3 id="b-1-normative-references"><bdi class="secno">B.1 </bdi>Normative references</h3><a class="self-link" href="#normative-references" aria-label="Permalink for Appendix B.1"></a></div>
    <dl class="bibliography"><dt id="bib-cors">[CORS]</dt><dd>
      <a href="https://www.w3.org/TR/cors/"><cite>Cross-Origin Resource Sharing</cite></a>. Anne van Kesteren.  W3C. 2 June 2020. W3C Recommendation. URL: <a href="https://www.w3.org/TR/cors/">https://www.w3.org/TR/cors/</a>
    </dd><dt id="bib-csp">[CSP]</dt><dd>
      <a href="https://www.w3.org/TR/CSP3/"><cite>Content Security Policy Level 3</cite></a>. Mike West; Antonio Sartori.  W3C. 4 September 2023. W3C Working Draft. URL: <a href="https://www.w3.org/TR/CSP3/">https://www.w3.org/TR/CSP3/</a>
    </dd><dt id="bib-oauth2.nlgov">[OAuth2.NLGov]</dt><dd>
      <a href="https://gitdocumentatie.logius.nl/publicatie/api/oauth/"><cite>NL GOV Assurance profile for OAuth 2.0</cite></a>. F. Terpstra; J. van Gelder.  Logius. july 2020. URL: <a href="https://gitdocumentatie.logius.nl/publicatie/api/oauth/">https://gitdocumentatie.logius.nl/publicatie/api/oauth/</a>
    </dd><dt id="bib-openid.core">[OpenID.Core]</dt><dd>
      <a href="https://openid.net/specs/openid-connect-core-1_0.html"><cite>OpenID Connect Core 1.0</cite></a>. N. Sakimura; J. Bradley; M. B. Jones; B. de Medeiros; C. Mortimore.  The OpenID Foundation. 2014. URL: <a href="https://openid.net/specs/openid-connect-core-1_0.html">https://openid.net/specs/openid-connect-core-1_0.html</a>
    </dd><dt id="bib-openid.discovery">[OpenID.Discovery]</dt><dd>
      <a href="https://openid.net/specs/openid-connect-discovery-1_0.html"><cite>OpenID Connect Discovery 1.0</cite></a>. N. Sakimura; J. Bradley; M. Jones; E. Jay.  The OpenID Foundation. 2014. URL: <a href="https://openid.net/specs/openid-connect-discovery-1_0.html">https://openid.net/specs/openid-connect-discovery-1_0.html</a>
    </dd><dt id="bib-openid.dynamic-registration">[OpenID.Dynamic-Registration]</dt><dd>
      <a href="https://openid.net/specs/openid-connect-registration-1_0.html"><cite>OpenID Connect Dynamic Client Registration 1.0</cite></a>. N. Sakimura; J. Bradley; M. Jones.  The OpenID Foundation. 2014. URL: <a href="https://openid.net/specs/openid-connect-registration-1_0.html">https://openid.net/specs/openid-connect-registration-1_0.html</a>
    </dd><dt id="bib-openid.igov">[OpenID.iGov]</dt><dd>
      <a href="https://openid.net/specs/openid-igov-openid-connect-1_0.html"><cite>International Government Assurance Profile (iGov) for OpenID Connect 1.0</cite></a>. M. Varley; P. Grassi.  The OpenID Foundation. 2018. URL: <a href="https://openid.net/specs/openid-igov-openid-connect-1_0.html">https://openid.net/specs/openid-igov-openid-connect-1_0.html</a>
    </dd><dt id="bib-rfc2119">[RFC2119]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
    </dd><dt id="bib-rfc2616">[RFC2616]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2616"><cite>Hypertext Transfer Protocol -- HTTP/1.1</cite></a>. R. Fielding; J. Gettys; J. Mogul; H. Frystyk; L. Masinter; P. Leach; T. Berners-Lee.  IETF. June 1999. Draft Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc2616">https://www.rfc-editor.org/rfc/rfc2616</a>
    </dd><dt id="bib-rfc3986">[RFC3986]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc3986"><cite>Uniform Resource Identifier (URI): Generic Syntax</cite></a>. T. Berners-Lee; R. Fielding; L. Masinter.  IETF. January 2005. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc3986">https://www.rfc-editor.org/rfc/rfc3986</a>
    </dd><dt id="bib-rfc6749">[RFC6749]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc6749"><cite>The OAuth 2.0 Authorization Framework</cite></a>. D. Hardt, Ed..  IETF. October 2012. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc6749">https://www.rfc-editor.org/rfc/rfc6749</a>
    </dd><dt id="bib-rfc6750">[RFC6750]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc6750"><cite>The OAuth 2.0 Authorization Framework: Bearer Token Usage</cite></a>. M. Jones; D. Hardt.  IETF. October 2012. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc6750">https://www.rfc-editor.org/rfc/rfc6750</a>
    </dd><dt id="bib-rfc6797">[RFC6797]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc6797"><cite>HTTP Strict Transport Security (HSTS)</cite></a>. J. Hodges; C. Jackson; A. Barth.  IETF. November 2012. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc6797">https://www.rfc-editor.org/rfc/rfc6797</a>
    </dd><dt id="bib-rfc6819">[RFC6819]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc6819"><cite>OAuth 2.0 Threat Model and Security Considerations</cite></a>. T. Lodderstedt, Ed.; M. McGloin; P. Hunt.  IETF. January 2013. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc6819">https://www.rfc-editor.org/rfc/rfc6819</a>
    </dd><dt id="bib-rfc7009">[RFC7009]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7009"><cite>OAuth 2.0 Token Revocation</cite></a>. T. Lodderstedt, Ed.; S. Dronia; M. Scurtescu.  IETF. August 2013. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7009">https://www.rfc-editor.org/rfc/rfc7009</a>
    </dd><dt id="bib-rfc7234">[RFC7234]</dt><dd>
      <a href="https://httpwg.org/specs/rfc7234.html"><cite>Hypertext Transfer Protocol (HTTP/1.1): Caching</cite></a>. R. Fielding, Ed.; M. Nottingham, Ed.; J. Reschke, Ed..  IETF. June 2014. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc7234.html">https://httpwg.org/specs/rfc7234.html</a>
    </dd><dt id="bib-rfc7515">[RFC7515]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7515"><cite>JSON Web Signature (JWS)</cite></a>. M. Jones; J. Bradley; N. Sakimura.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7515">https://www.rfc-editor.org/rfc/rfc7515</a>
    </dd><dt id="bib-rfc7516">[RFC7516]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7516"><cite>JSON Web Encryption (JWE)</cite></a>. M. Jones; J. Hildebrand.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7516">https://www.rfc-editor.org/rfc/rfc7516</a>
    </dd><dt id="bib-rfc7517">[RFC7517]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7517"><cite>JSON Web Key (JWK)</cite></a>. M. Jones.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7517">https://www.rfc-editor.org/rfc/rfc7517</a>
    </dd><dt id="bib-rfc7519">[RFC7519]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7519"><cite>JSON Web Token (JWT)</cite></a>. M. Jones; J. Bradley; N. Sakimura.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7519">https://www.rfc-editor.org/rfc/rfc7519</a>
    </dd><dt id="bib-rfc7523">[RFC7523]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7523"><cite>JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants</cite></a>. M. Jones; B. Campbell; C. Mortimore.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7523">https://www.rfc-editor.org/rfc/rfc7523</a>
    </dd><dt id="bib-rfc7525">[RFC7525]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7525"><cite>Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)</cite></a>. Y. Sheffer; R. Holz; P. Saint-Andre.  IETF. May 2015. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc7525">https://www.rfc-editor.org/rfc/rfc7525</a>
    </dd><dt id="bib-rfc7591">[RFC7591]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7591"><cite>OAuth 2.0 Dynamic Client Registration Protocol</cite></a>. J. Richer, Ed.; M. Jones; J. Bradley; M. Machulak; P. Hunt.  IETF. July 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7591">https://www.rfc-editor.org/rfc/rfc7591</a>
    </dd><dt id="bib-rfc7592">[RFC7592]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7592"><cite>OAuth 2.0 Dynamic Client Registration Management Protocol</cite></a>. J. Richer, Ed.; M. Jones; J. Bradley; M. Machulak.  IETF. July 2015. Experimental. URL: <a href="https://www.rfc-editor.org/rfc/rfc7592">https://www.rfc-editor.org/rfc/rfc7592</a>
    </dd><dt id="bib-rfc7636">[RFC7636]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7636"><cite>Proof Key for Code Exchange by OAuth Public Clients</cite></a>. N. Sakimura, Ed.; J. Bradley; N. Agarwal.  IETF. September 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7636">https://www.rfc-editor.org/rfc/rfc7636</a>
    </dd><dt id="bib-rfc7662">[RFC7662]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7662"><cite>OAuth 2.0 Token Introspection</cite></a>. J. Richer, Ed..  IETF. October 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7662">https://www.rfc-editor.org/rfc/rfc7662</a>
    </dd><dt id="bib-rfc7800">[RFC7800]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7800"><cite>Proof-of-Possession Key Semantics for JSON Web Tokens (JWTs)</cite></a>. M. Jones; J. Bradley; H. Tschofenig.  IETF. April 2016. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7800">https://www.rfc-editor.org/rfc/rfc7800</a>
    </dd><dt id="bib-rfc8174">[RFC8174]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
    </dd><dt id="bib-rfc8252">[RFC8252]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8252"><cite>OAuth 2.0 for Native Apps</cite></a>. W. Denniss; J. Bradley.  IETF. October 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8252">https://www.rfc-editor.org/rfc/rfc8252</a>
    </dd><dt id="bib-rfc8414">[RFC8414]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8414"><cite>OAuth 2.0 Authorization Server Metadata</cite></a>. M. Jones; N. Sakimura; J. Bradley.  IETF. June 2018. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc8414">https://www.rfc-editor.org/rfc/rfc8414</a>
    </dd><dt id="bib-rfc8485">[RFC8485]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8485"><cite>Vectors of Trust</cite></a>. J. Richer, Ed.; L. Johansson.  IETF. October 2018. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc8485">https://www.rfc-editor.org/rfc/rfc8485</a>
    </dd><dt id="bib-rfc8693">[RFC8693]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8693"><cite>OAuth 2.0 Token Exchange</cite></a>. M. Jones; A. Nadalin; B. Campbell, Ed.; J. Bradley; C. Mortimore.  IETF. January 2020. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc8693">https://www.rfc-editor.org/rfc/rfc8693</a>
    </dd><dt id="bib-rfc8705">[RFC8705]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8705"><cite>OAuth 2.0 Mutual-TLS Client Authentication and Certificate-Bound Access Tokens</cite></a>. B. Campbell; J. Bradley; N. Sakimura; T. Lodderstedt.  IETF. February 2020. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc8705">https://www.rfc-editor.org/rfc/rfc8705</a>
    </dd><dt id="bib-rfc8725">[RFC8725]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8725"><cite>JSON Web Token Best Current Practices</cite></a>. Y. Sheffer; D. Hardt; M. Jones.  IETF. February 2020. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8725">https://www.rfc-editor.org/rfc/rfc8725</a>
    </dd><dt id="bib-sg.loa">[SG.LoA]</dt><dd>
      <a href="https://www.forumstandaardisatie.nl/sites/default/files/BFS/4-basisinformatie/publicaties/Assurance-levels-for-digital-service-provision.pdf"><cite>Assurance level for digital service provision</cite></a>. .  The Standardisation Forum (NL). September 2017. URL: <a href="https://www.forumstandaardisatie.nl/sites/default/files/BFS/4-basisinformatie/publicaties/Assurance-levels-for-digital-service-provision.pdf">https://www.forumstandaardisatie.nl/sites/default/files/BFS/4-basisinformatie/publicaties/Assurance-levels-for-digital-service-provision.pdf</a>
    </dd><dt id="bib-sg.tls">[SG.TLS]</dt><dd>
      <a href="https://english.ncsc.nl/publications?keyword=IT+Security+Guidelines+for+Transport+Layer+Security&amp;start-date=&amp;end-date=&amp;topic=All+topics&amp;type=All+publications"><cite> IT Security Guidelines for Transport Layer Security (TLS)</cite></a>. .  NCSC. 23-05-2019. URL: <a href="https://english.ncsc.nl/publications?keyword=IT+Security+Guidelines+for+Transport+Layer+Security&amp;start-date=&amp;end-date=&amp;topic=All+topics&amp;type=All+publications">https://english.ncsc.nl/publications?keyword=IT+Security+Guidelines+for+Transport+Layer+Security&amp;start-date=&amp;end-date=&amp;topic=All+topics&amp;type=All+publications</a>
    </dd><dt id="bib-sri">[SRI]</dt><dd>
      <a href="https://www.w3.org/TR/SRI/"><cite>Subresource Integrity</cite></a>. Devdatta Akhawe; Frederik Braun; Francois Marier; Joel Weinberger.  W3C. 23 June 2016. W3C Recommendation. URL: <a href="https://www.w3.org/TR/SRI/">https://www.w3.org/TR/SRI/</a>
    </dd></dl>
  </section><section id="informative-references">
    <div class="header-wrapper"><h3 id="b-2-informative-references"><bdi class="secno">B.2 </bdi>Informative references</h3><a class="self-link" href="#informative-references" aria-label="Permalink for Appendix B.2"></a></div>
    <dl class="bibliography"><dt id="bib-eidas.saml">[eIDAS.SAML]</dt><dd>
      <a href="https://ec.europa.eu/cefdigital/wiki/download/attachments/82773108/eIDAS%20SAML%20Message%20Format%20v.1.2%20Final.pdf"><cite>eIDAS SAML Message Format</cite></a>.  eIDAS Coorperation Network. URL: <a href="https://ec.europa.eu/cefdigital/wiki/download/attachments/82773108/eIDAS%20SAML%20Message%20Format%20v.1.2%20Final.pdf">https://ec.europa.eu/cefdigital/wiki/download/attachments/82773108/eIDAS%20SAML%20Message%20Format%20v.1.2%20Final.pdf</a>
    </dd><dt id="bib-lo.gba">[LO.GBA]</dt><dd>
      <a href="h https://www.rvig.nl/logisch-ontwerp-brp "><cite> Logisch ontwerp BRP</cite></a>. .  RvIG. July 2023. URL: <a href="h https://www.rvig.nl/logisch-ontwerp-brp ">h https://www.rvig.nl/logisch-ontwerp-brp </a>
    </dd><dt id="bib-oauth2.1">[OAuth2.1]</dt><dd>
      <a href="https://tools.ietf.org/html/draft-parecki-oauth-v2-1"><cite>OAuth 2.1 Working draft</cite></a>. D. Hardt; A. Parecki; T. Lodderstedt.  IETF OAuth Working Group. April 2020. URL: <a href="https://tools.ietf.org/html/draft-parecki-oauth-v2-1">https://tools.ietf.org/html/draft-parecki-oauth-v2-1</a>
    </dd><dt id="bib-oauth2.browser-based-apps">[OAuth2.Browser-Based-Apps]</dt><dd>
      <a href="https://tools.ietf.org/html/draft-ietf-oauth-browser-based-apps"><cite>OAuth 2.0 for Browser-Based Apps</cite></a>. A. Parecki; D. Waite.  IETF OAuth Working Group. Internet-Draft. URL: <a href="https://tools.ietf.org/html/draft-ietf-oauth-browser-based-apps">https://tools.ietf.org/html/draft-ietf-oauth-browser-based-apps</a>
    </dd><dt id="bib-oauth2.jar">[OAuth2.JAR]</dt><dd>
      <a href="https://tools.ietf.org/html/draft-ietf-oauth-jwsreq"><cite>The OAuth 2.0 Authorization Framework: JWT Secured Authorization Request (JAR)</cite></a>. N. Sakimura; J. Bradley.  IETF OAuth Working Group. Internet-Draft. URL: <a href="https://tools.ietf.org/html/draft-ietf-oauth-jwsreq">https://tools.ietf.org/html/draft-ietf-oauth-jwsreq</a>
    </dd><dt id="bib-oauth2.jwt">[OAuth2.JWT]</dt><dd>
      <a href="https://tools.ietf.org/html/draft-ietf-oauth-access-token-jwt"><cite>JSON Web Token (JWT) Profile for OAuth 2.0 Access Tokens</cite></a>. V. Bertocci.  IETF OAuth Working Group. Internet-Draft. URL: <a href="https://tools.ietf.org/html/draft-ietf-oauth-access-token-jwt">https://tools.ietf.org/html/draft-ietf-oauth-access-token-jwt</a>
    </dd><dt id="bib-oauth2.par">[OAuth2.PAR]</dt><dd>
      <a href="https://tools.ietf.org/html/draft-lodderstedt-oauth-par"><cite>OAuth 2.0 Pushed Authorization Requests</cite></a>. T. Lodderstedt; B. Campbell; N. Sakimura; D. Tonge; F. Skokan.  IETF OAuth Working Group. Internet-Draft. URL: <a href="https://tools.ietf.org/html/draft-lodderstedt-oauth-par">https://tools.ietf.org/html/draft-lodderstedt-oauth-par</a>
    </dd><dt id="bib-oauth2.rar">[OAuth2.RAR]</dt><dd>
      <a href="https://tools.ietf.org/html/draft-lodderstedt-oauth-rar"><cite>OAuth 2.0 Rich Authorization Requests</cite></a>. T. Lodderstedt; J. Richer; B. Campbell.  IETF OAuth Working Group. Internet-Draft. URL: <a href="https://tools.ietf.org/html/draft-lodderstedt-oauth-rar">https://tools.ietf.org/html/draft-lodderstedt-oauth-rar</a>
    </dd><dt id="bib-oauth2.security">[OAuth2.Security]</dt><dd>
      <a href="https://tools.ietf.org/html/draft-ietf-oauth-security-topics"><cite>OAuth 2.0 Security Best Current Practice</cite></a>. T. Lodderstedt; J. Bradley; A. Labunets; D. Fett.  IETF OAuth Working Group. Internet-Draft. URL: <a href="https://tools.ietf.org/html/draft-ietf-oauth-security-topics">https://tools.ietf.org/html/draft-ietf-oauth-security-topics</a>
    </dd><dt id="bib-openid.federation">[OpenID.Federation]</dt><dd>
      <a href="https://openid.net/specs/openid-connect-federation-1_0-12.html"><cite>OpenID Connect Federation 1.0 - draft 12</cite></a>. R. Hedberg; M. Jones; A. Solberg; S. Gulliksson; J. Bradley. June 30, 2020. URL: <a href="https://openid.net/specs/openid-connect-federation-1_0-12.html">https://openid.net/specs/openid-connect-federation-1_0-12.html</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><div class="sidelabel">Logius Standard - Definitive version</div><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>